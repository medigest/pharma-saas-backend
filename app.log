2025-12-20 01:24:04,968 - app.api.v1.auth - INFO - Tentative de connexion pour l'email: kiongasplane@pharma.com
2025-12-20 01:24:05,427 - app.api.v1.auth - ERROR - Erreur inattendue lors de la connexion: UnicodeDecodeError('utf-8', b'connection to server at "localhost" (::1), port 5432 failed: FATAL:  authentification par mot de passe \xe9chou\xe9e pour l\'utilisateur  \xab postgres \xbb\n', 103, 104, 'invalid continuation byte')
2025-12-20 01:24:05,657 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 2759, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2239, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2108, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 1187, in _connection_for_bind
    conn = bind.connect()
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3285, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3309, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 711, in checkout
    rec = pool._do_get()
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 175, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 673, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 899, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 630, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\psycopg2\__init__.py", line 135, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe9 in position 103: invalid continuation byte

2025-12-20 01:24:05,662 - app.api.v1.auth - ERROR - Erreur lors de l'ouverture de la session DB: HTTPException(status_code=500, detail="Une erreur est survenue lors de l'authentification.")
2025-12-20 01:24:05,811 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 2759, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2239, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2108, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 1187, in _connection_for_bind
    conn = bind.connect()
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3285, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3309, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 711, in checkout
    rec = pool._do_get()
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 175, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 673, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 899, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 630, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\psycopg2\__init__.py", line 135, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe9 in position 103: invalid continuation byte

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 35, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\starlette\concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\to_thread.py", line 61, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2525, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 986, in run
    result = context.run(func, *args)
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 214, in login
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: Une erreur est survenue lors de l'authentification.

2025-12-20 02:16:11,119 - app.api.v1.auth - INFO - Tentative de connexion pour l'email: kiongasplane@pharma.com
2025-12-20 02:16:11,311 - app.api.v1.auth - ERROR - Erreur inattendue lors de la connexion: UnicodeDecodeError('utf-8', b'connection to server at "localhost" (::1), port 5432 failed: FATAL:  authentification par mot de passe \xe9chou\xe9e pour l\'utilisateur  \xab postgres \xbb\n', 103, 104, 'invalid continuation byte')
2025-12-20 02:16:11,342 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 2759, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2239, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2108, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 1187, in _connection_for_bind
    conn = bind.connect()
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3285, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3309, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 711, in checkout
    rec = pool._do_get()
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 175, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 673, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 899, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 630, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\psycopg2\__init__.py", line 135, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe9 in position 103: invalid continuation byte

2025-12-20 02:16:11,346 - app.api.v1.auth - ERROR - Erreur lors de l'ouverture de la session DB: HTTPException(status_code=500, detail="Une erreur est survenue lors de l'authentification.")
2025-12-20 02:16:11,367 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 2759, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2239, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2108, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 1187, in _connection_for_bind
    conn = bind.connect()
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3285, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3309, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 711, in checkout
    rec = pool._do_get()
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 175, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 673, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 899, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 630, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\psycopg2\__init__.py", line 135, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe9 in position 103: invalid continuation byte

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 35, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\starlette\concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\to_thread.py", line 61, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2525, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 986, in run
    result = context.run(func, *args)
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 214, in login
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: Une erreur est survenue lors de l'authentification.

2025-12-20 02:28:54,591 - app.api.v1.auth - INFO - Tentative de connexion pour l'email: kiongasplane@pharma.com
2025-12-20 02:28:54,852 - app.api.v1.auth - ERROR - Erreur inattendue lors de la connexion: UnicodeDecodeError('utf-8', b'connection to server at "localhost" (::1), port 5432 failed: FATAL:  authentification par mot de passe \xe9chou\xe9e pour l\'utilisateur  \xab postgres \xbb\n', 103, 104, 'invalid continuation byte')
2025-12-20 02:28:54,887 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 2759, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2239, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2108, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 1187, in _connection_for_bind
    conn = bind.connect()
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3285, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3309, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 711, in checkout
    rec = pool._do_get()
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 175, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 673, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 899, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 630, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\psycopg2\__init__.py", line 135, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe9 in position 103: invalid continuation byte

2025-12-20 02:28:54,891 - app.api.v1.auth - ERROR - Erreur lors de l'ouverture de la session DB: HTTPException(status_code=500, detail="Une erreur est survenue lors de l'authentification.")
2025-12-20 02:28:54,916 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 2759, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2239, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2108, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 1187, in _connection_for_bind
    conn = bind.connect()
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3285, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3309, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 711, in checkout
    rec = pool._do_get()
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 175, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 673, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 899, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 630, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\psycopg2\__init__.py", line 135, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe9 in position 103: invalid continuation byte

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 35, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\starlette\concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\to_thread.py", line 61, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2525, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 986, in run
    result = context.run(func, *args)
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 214, in login
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: Une erreur est survenue lors de l'authentification.

2025-12-20 02:38:18,521 - app.api.v1.auth - INFO - Tentative de connexion pour l'email: kiongasplane@pharma.com
2025-12-20 02:38:18,834 - app.api.v1.auth - ERROR - Erreur inattendue lors de la connexion: UnicodeDecodeError('utf-8', b'connection to server at "localhost" (::1), port 5432 failed: FATAL:  la base de donn\xe9es \xab pharma_saas \xbb n\'existe pas\n', 84, 85, 'invalid continuation byte')
2025-12-20 02:38:18,874 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 2759, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2239, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2108, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 1187, in _connection_for_bind
    conn = bind.connect()
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3285, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3309, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 711, in checkout
    rec = pool._do_get()
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 175, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 673, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 899, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 630, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\psycopg2\__init__.py", line 135, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe9 in position 84: invalid continuation byte

2025-12-20 02:38:18,879 - app.api.v1.auth - ERROR - Erreur lors de l'ouverture de la session DB: HTTPException(status_code=500, detail="Une erreur est survenue lors de l'authentification.")
2025-12-20 02:38:18,908 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 2759, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2239, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2108, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 1187, in _connection_for_bind
    conn = bind.connect()
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3285, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3309, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 711, in checkout
    rec = pool._do_get()
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 175, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 673, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 899, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 630, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\psycopg2\__init__.py", line 135, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe9 in position 84: invalid continuation byte

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 35, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\starlette\concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\to_thread.py", line 61, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2525, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 986, in run
    result = context.run(func, *args)
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 214, in login
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: Une erreur est survenue lors de l'authentification.

2025-12-20 02:47:52,280 - app.api.v1.auth - INFO - Tentative de connexion pour l'email: kiongasplane@pharma.com
2025-12-20 02:47:52,699 - app.api.v1.auth - ERROR - Erreur inattendue lors de la connexion: ProgrammingError("(psycopg2.errors.UndefinedTable) ERREUR:  la relation  users  n'existe pas\nLINE 2: FROM users \n             ^\n")
2025-12-20 02:47:52,852 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.UndefinedTable: ERREUR:  la relation  users  n'existe pas
LINE 2: FROM users 
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 2759, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedTable) ERREUR:  la relation  users  n'existe pas
LINE 2: FROM users 
             ^

[SQL: SELECT users.id AS users_id, users.tenant_id AS users_tenant_id, users.nom AS users_nom, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.actif AS users_actif, users.date_creation AS users_date_creation, users.last_login AS users_last_login 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s]
[parameters: {'email_1': 'kiongasplane@pharma.com', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-12-20 02:47:52,863 - app.api.v1.auth - ERROR - Erreur lors de l'ouverture de la session DB: HTTPException(status_code=500, detail="Une erreur est survenue lors de l'authentification.")
2025-12-20 02:47:52,907 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.UndefinedTable: ERREUR:  la relation  users  n'existe pas
LINE 2: FROM users 
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 2759, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedTable) ERREUR:  la relation  users  n'existe pas
LINE 2: FROM users 
             ^

[SQL: SELECT users.id AS users_id, users.tenant_id AS users_tenant_id, users.nom AS users_nom, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.actif AS users_actif, users.date_creation AS users_date_creation, users.last_login AS users_last_login 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s]
[parameters: {'email_1': 'kiongasplane@pharma.com', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 35, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\starlette\concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\to_thread.py", line 61, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2525, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 986, in run
    result = context.run(func, *args)
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 214, in login
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: Une erreur est survenue lors de l'authentification.

2025-12-20 07:49:29,697 - app.api.v1.auth - INFO - Tentative de connexion pour l'email: kiongasplane@pharma.com
2025-12-20 07:49:30,822 - app.api.v1.auth - ERROR - Erreur inattendue lors de la connexion: InvalidRequestError("When initializing mapper Mapper[Client(clients)], expression 'Sale' failed to locate a name ('Sale'). If this is a class name, consider adding this relationship() to the <class 'app.models.client.Client'> class after both dependent classes have been defined.")
2025-12-20 07:49:31,325 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 516, in _resolve_name
    rval = d[token]
           ~^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\_collections.py", line 345, in __missing__
    self[key] = val = self.creator(key)
                      ~~~~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 484, in _access_cls
    return self.fallback[key]
           ~~~~~~~~~~~~~^^^^^
KeyError: 'Sale'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1655, in do_init
    self._setup_entity()
    ~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1865, in _setup_entity
    self._clsregistry_resolve_name(argument)(),
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 520, in _resolve_name
    self._raise_for_name(name, err)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 501, in _raise_for_name
    raise exc.InvalidRequestError(
    ...<5 lines>...
    ) from err
sqlalchemy.exc.InvalidRequestError: When initializing mapper Mapper[Client(clients)], expression 'Sale' failed to locate a name ('Sale'). If this is a class name, consider adding this relationship() to the <class 'app.models.client.Client'> class after both dependent classes have been defined.

2025-12-20 07:49:31,385 - app.api.v1.auth - ERROR - Erreur lors de l'ouverture de la session DB: HTTPException(status_code=500, detail="Une erreur est survenue lors de l'authentification.")
2025-12-20 07:49:32,087 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 516, in _resolve_name
    rval = d[token]
           ~^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\_collections.py", line 345, in __missing__
    self[key] = val = self.creator(key)
                      ~~~~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 484, in _access_cls
    return self.fallback[key]
           ~~~~~~~~~~~~~^^^^^
KeyError: 'Sale'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1655, in do_init
    self._setup_entity()
    ~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1865, in _setup_entity
    self._clsregistry_resolve_name(argument)(),
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 520, in _resolve_name
    self._raise_for_name(name, err)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 501, in _raise_for_name
    raise exc.InvalidRequestError(
    ...<5 lines>...
    ) from err
sqlalchemy.exc.InvalidRequestError: When initializing mapper Mapper[Client(clients)], expression 'Sale' failed to locate a name ('Sale'). If this is a class name, consider adding this relationship() to the <class 'app.models.client.Client'> class after both dependent classes have been defined.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 35, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\starlette\concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\to_thread.py", line 61, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2525, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 986, in run
    result = context.run(func, *args)
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 214, in login
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: Une erreur est survenue lors de l'authentification.

2025-12-20 07:53:36,605 - app.api.v1.auth - INFO - Tentative de connexion pour l'email: kiongasplane@pharma.com
2025-12-20 07:53:36,744 - app.api.v1.auth - ERROR - Erreur inattendue lors de la connexion: NoForeignKeysError("Could not determine join condition between parent/child tables on relationship Client.debt_payments - there are no foreign keys linking these tables.  Ensure that referencing columns are associated with a ForeignKey or ForeignKeyConstraint, or specify a 'primaryjoin' expression.")
2025-12-20 07:53:36,856 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2434, in _determine_joins
    self.primaryjoin = join_condition(
                       ~~~~~~~~~~~~~~^
        self.parent_persist_selectable,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        consider_as_foreign_keys=consider_as_foreign_keys,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\util.py", line 121, in join_condition
    return Join._join_condition(
           ~~~~~~~~~~~~~~~~~~~~^
        a,
        ^^
    ...<2 lines>...
        consider_as_foreign_keys=consider_as_foreign_keys,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\selectable.py", line 1453, in _join_condition
    raise exc.NoForeignKeysError(
    ...<3 lines>...
    )
sqlalchemy.exc.NoForeignKeysError: Can't find any foreign key relationships between 'clients' and 'debt_payments'.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1657, in do_init
    self._setup_join_conditions()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1895, in _setup_join_conditions
    self._join_condition = jc = JoinCondition(
                                ~~~~~~~~~~~~~^
        parent_persist_selectable=self.parent.persist_selectable,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<14 lines>...
        can_be_synced_fn=self._columns_are_mapped,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2321, in __init__
    self._determine_joins()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2455, in _determine_joins
    raise sa_exc.NoForeignKeysError(
    ...<7 lines>...
    ) from nfe
sqlalchemy.exc.NoForeignKeysError: Could not determine join condition between parent/child tables on relationship Client.debt_payments - there are no foreign keys linking these tables.  Ensure that referencing columns are associated with a ForeignKey or ForeignKeyConstraint, or specify a 'primaryjoin' expression.

2025-12-20 07:53:36,862 - app.api.v1.auth - ERROR - Erreur lors de l'ouverture de la session DB: HTTPException(status_code=500, detail="Une erreur est survenue lors de l'authentification.")
2025-12-20 07:53:36,901 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2434, in _determine_joins
    self.primaryjoin = join_condition(
                       ~~~~~~~~~~~~~~^
        self.parent_persist_selectable,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        consider_as_foreign_keys=consider_as_foreign_keys,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\util.py", line 121, in join_condition
    return Join._join_condition(
           ~~~~~~~~~~~~~~~~~~~~^
        a,
        ^^
    ...<2 lines>...
        consider_as_foreign_keys=consider_as_foreign_keys,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\selectable.py", line 1453, in _join_condition
    raise exc.NoForeignKeysError(
    ...<3 lines>...
    )
sqlalchemy.exc.NoForeignKeysError: Can't find any foreign key relationships between 'clients' and 'debt_payments'.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1657, in do_init
    self._setup_join_conditions()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1895, in _setup_join_conditions
    self._join_condition = jc = JoinCondition(
                                ~~~~~~~~~~~~~^
        parent_persist_selectable=self.parent.persist_selectable,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<14 lines>...
        can_be_synced_fn=self._columns_are_mapped,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2321, in __init__
    self._determine_joins()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2455, in _determine_joins
    raise sa_exc.NoForeignKeysError(
    ...<7 lines>...
    ) from nfe
sqlalchemy.exc.NoForeignKeysError: Could not determine join condition between parent/child tables on relationship Client.debt_payments - there are no foreign keys linking these tables.  Ensure that referencing columns are associated with a ForeignKey or ForeignKeyConstraint, or specify a 'primaryjoin' expression.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 35, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\starlette\concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\to_thread.py", line 61, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2525, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 986, in run
    result = context.run(func, *args)
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 214, in login
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: Une erreur est survenue lors de l'authentification.

2025-12-20 08:00:17,626 - app.api.v1.auth - INFO - Tentative de connexion pour l'email: kiongasplane@pharma.com
2025-12-20 08:00:17,744 - app.api.v1.auth - ERROR - Erreur inattendue lors de la connexion: NoForeignKeysError("Could not determine join condition between parent/child tables on relationship Client.debt_payments - there are no foreign keys linking these tables.  Ensure that referencing columns are associated with a ForeignKey or ForeignKeyConstraint, or specify a 'primaryjoin' expression.")
2025-12-20 08:00:17,788 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2434, in _determine_joins
    self.primaryjoin = join_condition(
                       ~~~~~~~~~~~~~~^
        self.parent_persist_selectable,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        consider_as_foreign_keys=consider_as_foreign_keys,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\util.py", line 121, in join_condition
    return Join._join_condition(
           ~~~~~~~~~~~~~~~~~~~~^
        a,
        ^^
    ...<2 lines>...
        consider_as_foreign_keys=consider_as_foreign_keys,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\selectable.py", line 1453, in _join_condition
    raise exc.NoForeignKeysError(
    ...<3 lines>...
    )
sqlalchemy.exc.NoForeignKeysError: Can't find any foreign key relationships between 'clients' and 'debt_payments'.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1657, in do_init
    self._setup_join_conditions()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1895, in _setup_join_conditions
    self._join_condition = jc = JoinCondition(
                                ~~~~~~~~~~~~~^
        parent_persist_selectable=self.parent.persist_selectable,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<14 lines>...
        can_be_synced_fn=self._columns_are_mapped,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2321, in __init__
    self._determine_joins()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2455, in _determine_joins
    raise sa_exc.NoForeignKeysError(
    ...<7 lines>...
    ) from nfe
sqlalchemy.exc.NoForeignKeysError: Could not determine join condition between parent/child tables on relationship Client.debt_payments - there are no foreign keys linking these tables.  Ensure that referencing columns are associated with a ForeignKey or ForeignKeyConstraint, or specify a 'primaryjoin' expression.

2025-12-20 08:00:17,792 - app.api.v1.auth - ERROR - Erreur lors de l'ouverture de la session DB: HTTPException(status_code=500, detail="Une erreur est survenue lors de l'authentification.")
2025-12-20 08:00:17,820 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2434, in _determine_joins
    self.primaryjoin = join_condition(
                       ~~~~~~~~~~~~~~^
        self.parent_persist_selectable,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        consider_as_foreign_keys=consider_as_foreign_keys,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\util.py", line 121, in join_condition
    return Join._join_condition(
           ~~~~~~~~~~~~~~~~~~~~^
        a,
        ^^
    ...<2 lines>...
        consider_as_foreign_keys=consider_as_foreign_keys,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\selectable.py", line 1453, in _join_condition
    raise exc.NoForeignKeysError(
    ...<3 lines>...
    )
sqlalchemy.exc.NoForeignKeysError: Can't find any foreign key relationships between 'clients' and 'debt_payments'.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1657, in do_init
    self._setup_join_conditions()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1895, in _setup_join_conditions
    self._join_condition = jc = JoinCondition(
                                ~~~~~~~~~~~~~^
        parent_persist_selectable=self.parent.persist_selectable,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<14 lines>...
        can_be_synced_fn=self._columns_are_mapped,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2321, in __init__
    self._determine_joins()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2455, in _determine_joins
    raise sa_exc.NoForeignKeysError(
    ...<7 lines>...
    ) from nfe
sqlalchemy.exc.NoForeignKeysError: Could not determine join condition between parent/child tables on relationship Client.debt_payments - there are no foreign keys linking these tables.  Ensure that referencing columns are associated with a ForeignKey or ForeignKeyConstraint, or specify a 'primaryjoin' expression.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 35, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\starlette\concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\to_thread.py", line 61, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2525, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 986, in run
    result = context.run(func, *args)
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 214, in login
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: Une erreur est survenue lors de l'authentification.

2025-12-20 08:04:19,016 - app.api.v1.auth - INFO - Tentative de connexion pour l'email: kiongasplane@pharma.com
2025-12-20 08:04:19,096 - app.api.v1.auth - ERROR - Erreur inattendue lors de la connexion: NoForeignKeysError("Could not determine join condition between parent/child tables on relationship Client.debt_payments - there are no foreign keys linking these tables.  Ensure that referencing columns are associated with a ForeignKey or ForeignKeyConstraint, or specify a 'primaryjoin' expression.")
2025-12-20 08:04:19,116 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2434, in _determine_joins
    self.primaryjoin = join_condition(
                       ~~~~~~~~~~~~~~^
        self.parent_persist_selectable,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        consider_as_foreign_keys=consider_as_foreign_keys,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\util.py", line 121, in join_condition
    return Join._join_condition(
           ~~~~~~~~~~~~~~~~~~~~^
        a,
        ^^
    ...<2 lines>...
        consider_as_foreign_keys=consider_as_foreign_keys,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\selectable.py", line 1453, in _join_condition
    raise exc.NoForeignKeysError(
    ...<3 lines>...
    )
sqlalchemy.exc.NoForeignKeysError: Can't find any foreign key relationships between 'clients' and 'debt_payments'.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1657, in do_init
    self._setup_join_conditions()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1895, in _setup_join_conditions
    self._join_condition = jc = JoinCondition(
                                ~~~~~~~~~~~~~^
        parent_persist_selectable=self.parent.persist_selectable,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<14 lines>...
        can_be_synced_fn=self._columns_are_mapped,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2321, in __init__
    self._determine_joins()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2455, in _determine_joins
    raise sa_exc.NoForeignKeysError(
    ...<7 lines>...
    ) from nfe
sqlalchemy.exc.NoForeignKeysError: Could not determine join condition between parent/child tables on relationship Client.debt_payments - there are no foreign keys linking these tables.  Ensure that referencing columns are associated with a ForeignKey or ForeignKeyConstraint, or specify a 'primaryjoin' expression.

2025-12-20 08:04:19,119 - app.api.v1.auth - ERROR - Erreur lors de l'ouverture de la session DB: HTTPException(status_code=500, detail="Une erreur est survenue lors de l'authentification.")
2025-12-20 08:04:19,147 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2434, in _determine_joins
    self.primaryjoin = join_condition(
                       ~~~~~~~~~~~~~~^
        self.parent_persist_selectable,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        consider_as_foreign_keys=consider_as_foreign_keys,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\util.py", line 121, in join_condition
    return Join._join_condition(
           ~~~~~~~~~~~~~~~~~~~~^
        a,
        ^^
    ...<2 lines>...
        consider_as_foreign_keys=consider_as_foreign_keys,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\selectable.py", line 1453, in _join_condition
    raise exc.NoForeignKeysError(
    ...<3 lines>...
    )
sqlalchemy.exc.NoForeignKeysError: Can't find any foreign key relationships between 'clients' and 'debt_payments'.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1657, in do_init
    self._setup_join_conditions()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1895, in _setup_join_conditions
    self._join_condition = jc = JoinCondition(
                                ~~~~~~~~~~~~~^
        parent_persist_selectable=self.parent.persist_selectable,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<14 lines>...
        can_be_synced_fn=self._columns_are_mapped,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2321, in __init__
    self._determine_joins()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2455, in _determine_joins
    raise sa_exc.NoForeignKeysError(
    ...<7 lines>...
    ) from nfe
sqlalchemy.exc.NoForeignKeysError: Could not determine join condition between parent/child tables on relationship Client.debt_payments - there are no foreign keys linking these tables.  Ensure that referencing columns are associated with a ForeignKey or ForeignKeyConstraint, or specify a 'primaryjoin' expression.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 35, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\starlette\concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\to_thread.py", line 61, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2525, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 986, in run
    result = context.run(func, *args)
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 214, in login
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: Une erreur est survenue lors de l'authentification.

2025-12-20 08:12:35,626 - app.api.v1.auth - INFO - Tentative de connexion pour l'email: kiongasplane@pharma.com
2025-12-20 08:12:36,726 - app.api.v1.auth - ERROR - Erreur inattendue lors de la connexion: AttributeError("Class <class 'app.models.debt.DebtPayment'> does not have a mapped column named 'client_id'")
2025-12-20 08:12:37,123 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1654, in do_init
    self._process_dependent_arguments()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1695, in _process_dependent_arguments
    rel_arg._resolve_against_registry(self._clsregistry_resolvers[1])
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 270, in _resolve_against_registry
    self.resolved = clsregistry_resolver(
                    ~~~~~~~~~~~~~~~~~~~~~
        attr_value, self.name == "secondary"
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    )()
    ~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 533, in __call__
    x = eval(self.arg, globals(), self._dict)
  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=5924, pipe_handle=588)
    ^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 368, in __getattr__
    raise AttributeError(
    ...<2 lines>...
    )
AttributeError: Class <class 'app.models.debt.DebtPayment'> does not have a mapped column named 'client_id'

2025-12-20 08:12:37,206 - app.api.v1.auth - ERROR - Erreur lors de l'ouverture de la session DB: HTTPException(status_code=500, detail="Une erreur est survenue lors de l'authentification.")
2025-12-20 08:12:37,492 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1654, in do_init
    self._process_dependent_arguments()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1695, in _process_dependent_arguments
    rel_arg._resolve_against_registry(self._clsregistry_resolvers[1])
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 270, in _resolve_against_registry
    self.resolved = clsregistry_resolver(
                    ~~~~~~~~~~~~~~~~~~~~~
        attr_value, self.name == "secondary"
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    )()
    ~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 533, in __call__
    x = eval(self.arg, globals(), self._dict)
  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=5924, pipe_handle=588)
    ^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 368, in __getattr__
    raise AttributeError(
    ...<2 lines>...
    )
AttributeError: Class <class 'app.models.debt.DebtPayment'> does not have a mapped column named 'client_id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 35, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\starlette\concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\to_thread.py", line 61, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2525, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 986, in run
    result = context.run(func, *args)
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 214, in login
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: Une erreur est survenue lors de l'authentification.

2025-12-20 08:17:39,861 - app.api.v1.auth - INFO - Tentative de connexion pour l'email: kiongasplane@pharma.com
2025-12-20 08:17:39,945 - app.api.v1.auth - ERROR - Erreur inattendue lors de la connexion: AttributeError("Class <class 'app.models.sale.Sale'> does not have a mapped column named 'created_by'")
2025-12-20 08:17:40,085 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1654, in do_init
    self._process_dependent_arguments()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1695, in _process_dependent_arguments
    rel_arg._resolve_against_registry(self._clsregistry_resolvers[1])
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 270, in _resolve_against_registry
    self.resolved = clsregistry_resolver(
                    ~~~~~~~~~~~~~~~~~~~~~
        attr_value, self.name == "secondary"
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    )()
    ~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 533, in __call__
    x = eval(self.arg, globals(), self._dict)
  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=5924, pipe_handle=588)
     ^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 368, in __getattr__
    raise AttributeError(
    ...<2 lines>...
    )
AttributeError: Class <class 'app.models.sale.Sale'> does not have a mapped column named 'created_by'

2025-12-20 08:17:40,093 - app.api.v1.auth - ERROR - Erreur lors de l'ouverture de la session DB: HTTPException(status_code=500, detail="Une erreur est survenue lors de l'authentification.")
2025-12-20 08:17:40,151 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1654, in do_init
    self._process_dependent_arguments()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1695, in _process_dependent_arguments
    rel_arg._resolve_against_registry(self._clsregistry_resolvers[1])
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 270, in _resolve_against_registry
    self.resolved = clsregistry_resolver(
                    ~~~~~~~~~~~~~~~~~~~~~
        attr_value, self.name == "secondary"
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    )()
    ~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 533, in __call__
    x = eval(self.arg, globals(), self._dict)
  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=5924, pipe_handle=588)
     ^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 368, in __getattr__
    raise AttributeError(
    ...<2 lines>...
    )
AttributeError: Class <class 'app.models.sale.Sale'> does not have a mapped column named 'created_by'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 35, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\starlette\concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\to_thread.py", line 61, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2525, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 986, in run
    result = context.run(func, *args)
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 214, in login
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: Une erreur est survenue lors de l'authentification.

2025-12-20 08:24:05,775 - app.api.v1.auth - INFO - Tentative de connexion pour l'email: kiongasplane@pharma.com
2025-12-20 08:24:05,850 - app.api.v1.auth - ERROR - Erreur inattendue lors de la connexion: AttributeError("Class <class 'app.models.debt.DebtPayment'> does not have a mapped column named 'processed_by'")
2025-12-20 08:24:05,896 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1654, in do_init
    self._process_dependent_arguments()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1695, in _process_dependent_arguments
    rel_arg._resolve_against_registry(self._clsregistry_resolvers[1])
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 270, in _resolve_against_registry
    self.resolved = clsregistry_resolver(
                    ~~~~~~~~~~~~~~~~~~~~~
        attr_value, self.name == "secondary"
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    )()
    ~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 533, in __call__
    x = eval(self.arg, globals(), self._dict)
  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=5924, pipe_handle=588)
     ^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 368, in __getattr__
    raise AttributeError(
    ...<2 lines>...
    )
AttributeError: Class <class 'app.models.debt.DebtPayment'> does not have a mapped column named 'processed_by'

2025-12-20 08:24:05,900 - app.api.v1.auth - ERROR - Erreur lors de l'ouverture de la session DB: HTTPException(status_code=500, detail="Une erreur est survenue lors de l'authentification.")
2025-12-20 08:24:05,941 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1654, in do_init
    self._process_dependent_arguments()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1695, in _process_dependent_arguments
    rel_arg._resolve_against_registry(self._clsregistry_resolvers[1])
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 270, in _resolve_against_registry
    self.resolved = clsregistry_resolver(
                    ~~~~~~~~~~~~~~~~~~~~~
        attr_value, self.name == "secondary"
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    )()
    ~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 533, in __call__
    x = eval(self.arg, globals(), self._dict)
  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=5924, pipe_handle=588)
     ^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 368, in __getattr__
    raise AttributeError(
    ...<2 lines>...
    )
AttributeError: Class <class 'app.models.debt.DebtPayment'> does not have a mapped column named 'processed_by'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 35, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\starlette\concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\to_thread.py", line 61, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2525, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 986, in run
    result = context.run(func, *args)
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 214, in login
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: Une erreur est survenue lors de l'authentification.

2025-12-20 09:09:34,437 - app.api.v1.auth - INFO - Tentative de connexion pour l'email: kiongasplane@gmail.com
2025-12-20 09:09:34,535 - app.api.v1.auth - ERROR - Erreur inattendue lors de la connexion: AttributeError("Class <class 'app.models.debt.DebtPayment'> does not have a mapped column named 'processed_by'")
2025-12-20 09:09:34,654 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1654, in do_init
    self._process_dependent_arguments()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1695, in _process_dependent_arguments
    rel_arg._resolve_against_registry(self._clsregistry_resolvers[1])
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 270, in _resolve_against_registry
    self.resolved = clsregistry_resolver(
                    ~~~~~~~~~~~~~~~~~~~~~
        attr_value, self.name == "secondary"
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    )()
    ~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 533, in __call__
    x = eval(self.arg, globals(), self._dict)
  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=6416, pipe_handle=572)
    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 368, in __getattr__
    raise AttributeError(
    ...<2 lines>...
    )
AttributeError: Class <class 'app.models.debt.DebtPayment'> does not have a mapped column named 'processed_by'

2025-12-20 09:09:34,657 - app.api.v1.auth - ERROR - Erreur lors de l'ouverture de la session DB: HTTPException(status_code=500, detail="Une erreur est survenue lors de l'authentification.")
2025-12-20 09:09:34,988 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1654, in do_init
    self._process_dependent_arguments()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1695, in _process_dependent_arguments
    rel_arg._resolve_against_registry(self._clsregistry_resolvers[1])
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 270, in _resolve_against_registry
    self.resolved = clsregistry_resolver(
                    ~~~~~~~~~~~~~~~~~~~~~
        attr_value, self.name == "secondary"
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    )()
    ~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 533, in __call__
    x = eval(self.arg, globals(), self._dict)
  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=6416, pipe_handle=572)
    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 368, in __getattr__
    raise AttributeError(
    ...<2 lines>...
    )
AttributeError: Class <class 'app.models.debt.DebtPayment'> does not have a mapped column named 'processed_by'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 35, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\starlette\concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\to_thread.py", line 61, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2525, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 986, in run
    result = context.run(func, *args)
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 214, in login
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: Une erreur est survenue lors de l'authentification.

2025-12-20 09:18:18,293 - app.api.v1.auth - INFO - Tentative de connexion pour l'email: kiongasplane@gmail.com
2025-12-20 09:18:18,509 - app.api.v1.auth - ERROR - Erreur inattendue lors de la connexion: InvalidRequestError('When initializing mapper Mapper[User(users)], expression \'DebtPayment.processed_by\' failed to locate a name ("name \'DebtPayment\' is not defined"). If this is a class name, consider adding this relationship() to the <class \'app.models.user.User\'> class after both dependent classes have been defined.')
2025-12-20 09:18:18,595 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 533, in __call__
    x = eval(self.arg, globals(), self._dict)
  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=6416, pipe_handle=1336)
    ^^^^^^^^^^^
NameError: name 'DebtPayment' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1654, in do_init
    self._process_dependent_arguments()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1695, in _process_dependent_arguments
    rel_arg._resolve_against_registry(self._clsregistry_resolvers[1])
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 270, in _resolve_against_registry
    self.resolved = clsregistry_resolver(
                    ~~~~~~~~~~~~~~~~~~~~~
        attr_value, self.name == "secondary"
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    )()
    ~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 540, in __call__
    self._raise_for_name(n.args[0], n)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 501, in _raise_for_name
    raise exc.InvalidRequestError(
    ...<5 lines>...
    ) from err
sqlalchemy.exc.InvalidRequestError: When initializing mapper Mapper[User(users)], expression 'DebtPayment.processed_by' failed to locate a name ("name 'DebtPayment' is not defined"). If this is a class name, consider adding this relationship() to the <class 'app.models.user.User'> class after both dependent classes have been defined.

2025-12-20 09:18:18,607 - app.api.v1.auth - ERROR - Erreur lors de l'ouverture de la session DB: HTTPException(status_code=500, detail="Une erreur est survenue lors de l'authentification.")
2025-12-20 09:18:18,700 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 533, in __call__
    x = eval(self.arg, globals(), self._dict)
  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=6416, pipe_handle=1336)
    ^^^^^^^^^^^
NameError: name 'DebtPayment' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1654, in do_init
    self._process_dependent_arguments()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1695, in _process_dependent_arguments
    rel_arg._resolve_against_registry(self._clsregistry_resolvers[1])
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 270, in _resolve_against_registry
    self.resolved = clsregistry_resolver(
                    ~~~~~~~~~~~~~~~~~~~~~
        attr_value, self.name == "secondary"
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    )()
    ~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 540, in __call__
    self._raise_for_name(n.args[0], n)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 501, in _raise_for_name
    raise exc.InvalidRequestError(
    ...<5 lines>...
    ) from err
sqlalchemy.exc.InvalidRequestError: When initializing mapper Mapper[User(users)], expression 'DebtPayment.processed_by' failed to locate a name ("name 'DebtPayment' is not defined"). If this is a class name, consider adding this relationship() to the <class 'app.models.user.User'> class after both dependent classes have been defined.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 35, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\starlette\concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\to_thread.py", line 61, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2525, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 986, in run
    result = context.run(func, *args)
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 214, in login
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: Une erreur est survenue lors de l'authentification.

2025-12-20 09:20:42,318 - app.api.v1.auth - INFO - Tentative de connexion pour l'email: kiongasplane@gmail.com
2025-12-20 09:20:42,459 - app.api.v1.auth - ERROR - Erreur inattendue lors de la connexion: InvalidRequestError("Mapper 'Mapper[User(users)]' has no property 'costs_created'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.")
2025-12-20 09:20:42,514 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2531, in get_property
    return self._props[key]
           ~~~~~~~~~~~^^^^^
KeyError: 'costs_created'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1660, in do_init
    self._generate_backref()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2144, in _generate_backref
    self._add_reverse_property(self.back_populates)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1591, in _add_reverse_property
    other = self.mapper.get_property(key, _configure_mappers=False)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2533, in get_property
    raise sa_exc.InvalidRequestError(
    ...<3 lines>...
    ) from err
sqlalchemy.exc.InvalidRequestError: Mapper 'Mapper[User(users)]' has no property 'costs_created'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

2025-12-20 09:20:42,519 - app.api.v1.auth - ERROR - Erreur lors de l'ouverture de la session DB: HTTPException(status_code=500, detail="Une erreur est survenue lors de l'authentification.")
2025-12-20 09:20:42,550 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2531, in get_property
    return self._props[key]
           ~~~~~~~~~~~^^^^^
KeyError: 'costs_created'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1660, in do_init
    self._generate_backref()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2144, in _generate_backref
    self._add_reverse_property(self.back_populates)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1591, in _add_reverse_property
    other = self.mapper.get_property(key, _configure_mappers=False)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2533, in get_property
    raise sa_exc.InvalidRequestError(
    ...<3 lines>...
    ) from err
sqlalchemy.exc.InvalidRequestError: Mapper 'Mapper[User(users)]' has no property 'costs_created'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 35, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\starlette\concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\to_thread.py", line 61, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2525, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 986, in run
    result = context.run(func, *args)
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 214, in login
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: Une erreur est survenue lors de l'authentification.

2025-12-20 09:25:01,486 - app.api.v1.auth - INFO - Tentative de connexion pour l'email: kiongasplane@gmail.com
2025-12-20 09:25:01,534 - app.api.v1.auth - ERROR - Erreur inattendue lors de la connexion: AttributeError("Class <class 'app.models.invoice.Invoice'> does not have a mapped column named 'created_by'")
2025-12-20 09:25:01,565 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1654, in do_init
    self._process_dependent_arguments()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1695, in _process_dependent_arguments
    rel_arg._resolve_against_registry(self._clsregistry_resolvers[1])
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 270, in _resolve_against_registry
    self.resolved = clsregistry_resolver(
                    ~~~~~~~~~~~~~~~~~~~~~
        attr_value, self.name == "secondary"
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    )()
    ~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 533, in __call__
    x = eval(self.arg, globals(), self._dict)
  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=6416, pipe_handle=1336)
     ^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 368, in __getattr__
    raise AttributeError(
    ...<2 lines>...
    )
AttributeError: Class <class 'app.models.invoice.Invoice'> does not have a mapped column named 'created_by'

2025-12-20 09:25:01,568 - app.api.v1.auth - ERROR - Erreur lors de l'ouverture de la session DB: HTTPException(status_code=500, detail="Une erreur est survenue lors de l'authentification.")
2025-12-20 09:25:01,589 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1654, in do_init
    self._process_dependent_arguments()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1695, in _process_dependent_arguments
    rel_arg._resolve_against_registry(self._clsregistry_resolvers[1])
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 270, in _resolve_against_registry
    self.resolved = clsregistry_resolver(
                    ~~~~~~~~~~~~~~~~~~~~~
        attr_value, self.name == "secondary"
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    )()
    ~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 533, in __call__
    x = eval(self.arg, globals(), self._dict)
  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=6416, pipe_handle=1336)
     ^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 368, in __getattr__
    raise AttributeError(
    ...<2 lines>...
    )
AttributeError: Class <class 'app.models.invoice.Invoice'> does not have a mapped column named 'created_by'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 35, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\starlette\concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\to_thread.py", line 61, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2525, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 986, in run
    result = context.run(func, *args)
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 214, in login
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: Une erreur est survenue lors de l'authentification.

2025-12-20 09:34:49,021 - app.api.v1.auth - INFO - Tentative de connexion pour l'email: kiongasplane@gmail.com
2025-12-20 09:34:49,164 - app.api.v1.auth - ERROR - Erreur inattendue lors de la connexion: InvalidRequestError("Mapper 'Mapper[Tenant(tenants)]' has no property 'costs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.")
2025-12-20 09:34:49,191 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2531, in get_property
    return self._props[key]
           ~~~~~~~~~~~^^^^^
KeyError: 'costs'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1660, in do_init
    self._generate_backref()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2144, in _generate_backref
    self._add_reverse_property(self.back_populates)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1591, in _add_reverse_property
    other = self.mapper.get_property(key, _configure_mappers=False)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2533, in get_property
    raise sa_exc.InvalidRequestError(
    ...<3 lines>...
    ) from err
sqlalchemy.exc.InvalidRequestError: Mapper 'Mapper[Tenant(tenants)]' has no property 'costs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

2025-12-20 09:34:49,196 - app.api.v1.auth - ERROR - Erreur lors de l'ouverture de la session DB: HTTPException(status_code=500, detail="Une erreur est survenue lors de l'authentification.")
2025-12-20 09:34:49,225 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2531, in get_property
    return self._props[key]
           ~~~~~~~~~~~^^^^^
KeyError: 'costs'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1660, in do_init
    self._generate_backref()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2144, in _generate_backref
    self._add_reverse_property(self.back_populates)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1591, in _add_reverse_property
    other = self.mapper.get_property(key, _configure_mappers=False)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2533, in get_property
    raise sa_exc.InvalidRequestError(
    ...<3 lines>...
    ) from err
sqlalchemy.exc.InvalidRequestError: Mapper 'Mapper[Tenant(tenants)]' has no property 'costs'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 35, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\starlette\concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\to_thread.py", line 61, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2525, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 986, in run
    result = context.run(func, *args)
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 214, in login
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: Une erreur est survenue lors de l'authentification.

2025-12-20 09:35:33,872 - app.api.v1.auth - INFO - Tentative de connexion pour l'email: kiongasplane@gmail.com
2025-12-20 09:35:34,003 - app.api.v1.auth - ERROR - Erreur inattendue lors de la connexion: InvalidRequestError("Mapper 'Mapper[Tenant(tenants)]' has no property 'budgets'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.")
2025-12-20 09:35:34,034 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2531, in get_property
    return self._props[key]
           ~~~~~~~~~~~^^^^^
KeyError: 'budgets'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1660, in do_init
    self._generate_backref()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2144, in _generate_backref
    self._add_reverse_property(self.back_populates)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1591, in _add_reverse_property
    other = self.mapper.get_property(key, _configure_mappers=False)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2533, in get_property
    raise sa_exc.InvalidRequestError(
    ...<3 lines>...
    ) from err
sqlalchemy.exc.InvalidRequestError: Mapper 'Mapper[Tenant(tenants)]' has no property 'budgets'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

2025-12-20 09:35:34,040 - app.api.v1.auth - ERROR - Erreur lors de l'ouverture de la session DB: HTTPException(status_code=500, detail="Une erreur est survenue lors de l'authentification.")
2025-12-20 09:35:34,066 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2531, in get_property
    return self._props[key]
           ~~~~~~~~~~~^^^^^
KeyError: 'budgets'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1660, in do_init
    self._generate_backref()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2144, in _generate_backref
    self._add_reverse_property(self.back_populates)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1591, in _add_reverse_property
    other = self.mapper.get_property(key, _configure_mappers=False)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2533, in get_property
    raise sa_exc.InvalidRequestError(
    ...<3 lines>...
    ) from err
sqlalchemy.exc.InvalidRequestError: Mapper 'Mapper[Tenant(tenants)]' has no property 'budgets'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 35, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\starlette\concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\to_thread.py", line 61, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2525, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 986, in run
    result = context.run(func, *args)
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 214, in login
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: Une erreur est survenue lors de l'authentification.

2025-12-20 09:39:21,135 - app.api.v1.auth - INFO - Tentative de connexion pour l'email: kiongasplane@gmail.com
2025-12-20 09:39:21,218 - app.api.v1.auth - ERROR - Erreur inattendue lors de la connexion: InvalidRequestError("Mapper 'Mapper[Tenant(tenants)]' has no property 'suppliers'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.")
2025-12-20 09:39:21,234 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2531, in get_property
    return self._props[key]
           ~~~~~~~~~~~^^^^^
KeyError: 'suppliers'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1660, in do_init
    self._generate_backref()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2144, in _generate_backref
    self._add_reverse_property(self.back_populates)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1591, in _add_reverse_property
    other = self.mapper.get_property(key, _configure_mappers=False)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2533, in get_property
    raise sa_exc.InvalidRequestError(
    ...<3 lines>...
    ) from err
sqlalchemy.exc.InvalidRequestError: Mapper 'Mapper[Tenant(tenants)]' has no property 'suppliers'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

2025-12-20 09:39:21,236 - app.api.v1.auth - ERROR - Erreur lors de l'ouverture de la session DB: HTTPException(status_code=500, detail="Une erreur est survenue lors de l'authentification.")
2025-12-20 09:39:21,249 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2531, in get_property
    return self._props[key]
           ~~~~~~~~~~~^^^^^
KeyError: 'suppliers'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1660, in do_init
    self._generate_backref()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2144, in _generate_backref
    self._add_reverse_property(self.back_populates)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1591, in _add_reverse_property
    other = self.mapper.get_property(key, _configure_mappers=False)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2533, in get_property
    raise sa_exc.InvalidRequestError(
    ...<3 lines>...
    ) from err
sqlalchemy.exc.InvalidRequestError: Mapper 'Mapper[Tenant(tenants)]' has no property 'suppliers'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 35, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\starlette\concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\to_thread.py", line 61, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2525, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 986, in run
    result = context.run(func, *args)
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 214, in login
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: Une erreur est survenue lors de l'authentification.

2025-12-20 09:46:03,488 - app.api.v1.auth - INFO - Tentative de connexion pour l'email: kiongasplane@gmail.com
2025-12-20 09:46:03,552 - app.api.v1.auth - ERROR - Erreur inattendue lors de la connexion: AttributeError("Class <class 'app.models.cost.Cost'> does not have a mapped column named 'is_active'")
2025-12-20 09:46:03,606 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1654, in do_init
    self._process_dependent_arguments()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1695, in _process_dependent_arguments
    rel_arg._resolve_against_registry(self._clsregistry_resolvers[1])
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 270, in _resolve_against_registry
    self.resolved = clsregistry_resolver(
                    ~~~~~~~~~~~~~~~~~~~~~
        attr_value, self.name == "secondary"
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    )()
    ~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 533, in __call__
    x = eval(self.arg, globals(), self._dict)
  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=13640, pipe_handle=208)
                                    ^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 368, in __getattr__
    raise AttributeError(
    ...<2 lines>...
    )
AttributeError: Class <class 'app.models.cost.Cost'> does not have a mapped column named 'is_active'

2025-12-20 09:46:03,649 - app.api.v1.auth - ERROR - Erreur lors de l'ouverture de la session DB: HTTPException(status_code=500, detail="Une erreur est survenue lors de l'authentification.")
2025-12-20 09:46:03,706 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1654, in do_init
    self._process_dependent_arguments()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1695, in _process_dependent_arguments
    rel_arg._resolve_against_registry(self._clsregistry_resolvers[1])
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 270, in _resolve_against_registry
    self.resolved = clsregistry_resolver(
                    ~~~~~~~~~~~~~~~~~~~~~
        attr_value, self.name == "secondary"
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    )()
    ~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 533, in __call__
    x = eval(self.arg, globals(), self._dict)
  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=13640, pipe_handle=208)
                                    ^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 368, in __getattr__
    raise AttributeError(
    ...<2 lines>...
    )
AttributeError: Class <class 'app.models.cost.Cost'> does not have a mapped column named 'is_active'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 35, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\starlette\concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\to_thread.py", line 61, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2525, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 986, in run
    result = context.run(func, *args)
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 214, in login
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: Une erreur est survenue lors de l'authentification.

2025-12-20 09:52:06,680 - app.api.v1.auth - INFO - Tentative de connexion pour l'email: kiongasplane@gmail.com
2025-12-20 09:52:07,163 - app.api.v1.auth - ERROR - Erreur inattendue lors de la connexion: ArgumentError("Error creating backref 'inventory_schedules' on relationship 'InventorySchedule.tenant': property of that name exists on mapper 'Mapper[Tenant(tenants)]'")
2025-12-20 09:52:07,195 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1660, in do_init
    self._generate_backref()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2086, in _generate_backref
    raise sa_exc.ArgumentError(
    ...<4 lines>...
    )
sqlalchemy.exc.ArgumentError: Error creating backref 'inventory_schedules' on relationship 'InventorySchedule.tenant': property of that name exists on mapper 'Mapper[Tenant(tenants)]'

2025-12-20 09:52:07,198 - app.api.v1.auth - ERROR - Erreur lors de l'ouverture de la session DB: HTTPException(status_code=500, detail="Une erreur est survenue lors de l'authentification.")
2025-12-20 09:52:07,219 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1660, in do_init
    self._generate_backref()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2086, in _generate_backref
    raise sa_exc.ArgumentError(
    ...<4 lines>...
    )
sqlalchemy.exc.ArgumentError: Error creating backref 'inventory_schedules' on relationship 'InventorySchedule.tenant': property of that name exists on mapper 'Mapper[Tenant(tenants)]'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 35, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\starlette\concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\to_thread.py", line 61, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2525, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 986, in run
    result = context.run(func, *args)
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 214, in login
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: Une erreur est survenue lors de l'authentification.

2025-12-20 10:12:44,420 - app.api.v1.auth - INFO - Tentative de connexion pour l'email: kiongasplane@gmail.com
2025-12-20 10:12:44,870 - app.api.v1.auth - ERROR - Erreur inattendue lors de la connexion: InvalidRequestError("Mapper 'Mapper[Tenant(tenants)]' has no property 'financial_periods'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.")
2025-12-20 10:12:44,927 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2531, in get_property
    return self._props[key]
           ~~~~~~~~~~~^^^^^
KeyError: 'financial_periods'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1660, in do_init
    self._generate_backref()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2144, in _generate_backref
    self._add_reverse_property(self.back_populates)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1591, in _add_reverse_property
    other = self.mapper.get_property(key, _configure_mappers=False)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2533, in get_property
    raise sa_exc.InvalidRequestError(
    ...<3 lines>...
    ) from err
sqlalchemy.exc.InvalidRequestError: Mapper 'Mapper[Tenant(tenants)]' has no property 'financial_periods'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

2025-12-20 10:12:44,934 - app.api.v1.auth - ERROR - Erreur lors de l'ouverture de la session DB: HTTPException(status_code=500, detail="Une erreur est survenue lors de l'authentification.")
2025-12-20 10:12:45,005 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2531, in get_property
    return self._props[key]
           ~~~~~~~~~~~^^^^^
KeyError: 'financial_periods'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1660, in do_init
    self._generate_backref()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2144, in _generate_backref
    self._add_reverse_property(self.back_populates)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1591, in _add_reverse_property
    other = self.mapper.get_property(key, _configure_mappers=False)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2533, in get_property
    raise sa_exc.InvalidRequestError(
    ...<3 lines>...
    ) from err
sqlalchemy.exc.InvalidRequestError: Mapper 'Mapper[Tenant(tenants)]' has no property 'financial_periods'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 35, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\starlette\concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\to_thread.py", line 61, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2525, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 986, in run
    result = context.run(func, *args)
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 214, in login
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: Une erreur est survenue lors de l'authentification.

2025-12-20 11:31:01,890 - app.api.v1.auth - INFO - Tentative de connexion pour l'email: kiongasplane@gmail.com
2025-12-20 11:31:02,229 - app.api.v1.auth - ERROR - Erreur inattendue lors de la connexion: InvalidRequestError("When initializing mapper Mapper[Product(products)], expression 'StockMovement' failed to locate a name ('StockMovement'). If this is a class name, consider adding this relationship() to the <class 'app.models.product.Product'> class after both dependent classes have been defined.")
2025-12-20 11:31:02,326 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 516, in _resolve_name
    rval = d[token]
           ~^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\_collections.py", line 345, in __missing__
    self[key] = val = self.creator(key)
                      ~~~~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 484, in _access_cls
    return self.fallback[key]
           ~~~~~~~~~~~~~^^^^^
KeyError: 'StockMovement'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1655, in do_init
    self._setup_entity()
    ~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1865, in _setup_entity
    self._clsregistry_resolve_name(argument)(),
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 520, in _resolve_name
    self._raise_for_name(name, err)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 501, in _raise_for_name
    raise exc.InvalidRequestError(
    ...<5 lines>...
    ) from err
sqlalchemy.exc.InvalidRequestError: When initializing mapper Mapper[Product(products)], expression 'StockMovement' failed to locate a name ('StockMovement'). If this is a class name, consider adding this relationship() to the <class 'app.models.product.Product'> class after both dependent classes have been defined.

2025-12-20 11:31:02,332 - app.api.v1.auth - ERROR - Erreur lors de l'ouverture de la session DB: HTTPException(status_code=500, detail="Une erreur est survenue lors de l'authentification.")
2025-12-20 11:31:02,598 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 516, in _resolve_name
    rval = d[token]
           ~^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\_collections.py", line 345, in __missing__
    self[key] = val = self.creator(key)
                      ~~~~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 484, in _access_cls
    return self.fallback[key]
           ~~~~~~~~~~~~~^^^^^
KeyError: 'StockMovement'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1655, in do_init
    self._setup_entity()
    ~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1865, in _setup_entity
    self._clsregistry_resolve_name(argument)(),
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 520, in _resolve_name
    self._raise_for_name(name, err)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 501, in _raise_for_name
    raise exc.InvalidRequestError(
    ...<5 lines>...
    ) from err
sqlalchemy.exc.InvalidRequestError: When initializing mapper Mapper[Product(products)], expression 'StockMovement' failed to locate a name ('StockMovement'). If this is a class name, consider adding this relationship() to the <class 'app.models.product.Product'> class after both dependent classes have been defined.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 35, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\starlette\concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\to_thread.py", line 61, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2525, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 986, in run
    result = context.run(func, *args)
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 214, in login
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: Une erreur est survenue lors de l'authentification.

2025-12-20 11:35:47,664 - app.api.v1.auth - INFO - Tentative de connexion pour l'email: kiongasplane@gmail.com
2025-12-20 11:35:47,870 - app.api.v1.auth - ERROR - Erreur inattendue lors de la connexion: InvalidRequestError("When initializing mapper Mapper[Product(products)], expression 'PhysicalInventoryItem' failed to locate a name ('PhysicalInventoryItem'). If this is a class name, consider adding this relationship() to the <class 'app.models.product.Product'> class after both dependent classes have been defined.")
2025-12-20 11:35:47,909 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 516, in _resolve_name
    rval = d[token]
           ~^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\_collections.py", line 345, in __missing__
    self[key] = val = self.creator(key)
                      ~~~~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 484, in _access_cls
    return self.fallback[key]
           ~~~~~~~~~~~~~^^^^^
KeyError: 'PhysicalInventoryItem'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1655, in do_init
    self._setup_entity()
    ~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1865, in _setup_entity
    self._clsregistry_resolve_name(argument)(),
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 520, in _resolve_name
    self._raise_for_name(name, err)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 501, in _raise_for_name
    raise exc.InvalidRequestError(
    ...<5 lines>...
    ) from err
sqlalchemy.exc.InvalidRequestError: When initializing mapper Mapper[Product(products)], expression 'PhysicalInventoryItem' failed to locate a name ('PhysicalInventoryItem'). If this is a class name, consider adding this relationship() to the <class 'app.models.product.Product'> class after both dependent classes have been defined.

2025-12-20 11:35:47,912 - app.api.v1.auth - ERROR - Erreur lors de l'ouverture de la session DB: HTTPException(status_code=500, detail="Une erreur est survenue lors de l'authentification.")
2025-12-20 11:35:47,936 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 516, in _resolve_name
    rval = d[token]
           ~^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\_collections.py", line 345, in __missing__
    self[key] = val = self.creator(key)
                      ~~~~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 484, in _access_cls
    return self.fallback[key]
           ~~~~~~~~~~~~~^^^^^
KeyError: 'PhysicalInventoryItem'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1655, in do_init
    self._setup_entity()
    ~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1865, in _setup_entity
    self._clsregistry_resolve_name(argument)(),
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 520, in _resolve_name
    self._raise_for_name(name, err)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 501, in _raise_for_name
    raise exc.InvalidRequestError(
    ...<5 lines>...
    ) from err
sqlalchemy.exc.InvalidRequestError: When initializing mapper Mapper[Product(products)], expression 'PhysicalInventoryItem' failed to locate a name ('PhysicalInventoryItem'). If this is a class name, consider adding this relationship() to the <class 'app.models.product.Product'> class after both dependent classes have been defined.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 35, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\starlette\concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\to_thread.py", line 61, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2525, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 986, in run
    result = context.run(func, *args)
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 214, in login
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: Une erreur est survenue lors de l'authentification.

2025-12-20 11:37:40,010 - app.api.v1.auth - INFO - Tentative de connexion pour l'email: kiongasplane@gmail.com
2025-12-20 11:37:40,477 - app.api.v1.auth - ERROR - Erreur inattendue lors de la connexion: InvalidRequestError("When initializing mapper Mapper[Sale(sales)], expression 'Refund' failed to locate a name ('Refund'). If this is a class name, consider adding this relationship() to the <class 'app.models.sale.Sale'> class after both dependent classes have been defined.")
2025-12-20 11:37:40,557 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 516, in _resolve_name
    rval = d[token]
           ~^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\_collections.py", line 345, in __missing__
    self[key] = val = self.creator(key)
                      ~~~~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 484, in _access_cls
    return self.fallback[key]
           ~~~~~~~~~~~~~^^^^^
KeyError: 'Refund'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1655, in do_init
    self._setup_entity()
    ~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1865, in _setup_entity
    self._clsregistry_resolve_name(argument)(),
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 520, in _resolve_name
    self._raise_for_name(name, err)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 501, in _raise_for_name
    raise exc.InvalidRequestError(
    ...<5 lines>...
    ) from err
sqlalchemy.exc.InvalidRequestError: When initializing mapper Mapper[Sale(sales)], expression 'Refund' failed to locate a name ('Refund'). If this is a class name, consider adding this relationship() to the <class 'app.models.sale.Sale'> class after both dependent classes have been defined.

2025-12-20 11:37:40,567 - app.api.v1.auth - ERROR - Erreur lors de l'ouverture de la session DB: HTTPException(status_code=500, detail="Une erreur est survenue lors de l'authentification.")
2025-12-20 11:37:40,641 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 516, in _resolve_name
    rval = d[token]
           ~^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\_collections.py", line 345, in __missing__
    self[key] = val = self.creator(key)
                      ~~~~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 484, in _access_cls
    return self.fallback[key]
           ~~~~~~~~~~~~~^^^^^
KeyError: 'Refund'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1655, in do_init
    self._setup_entity()
    ~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1865, in _setup_entity
    self._clsregistry_resolve_name(argument)(),
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 520, in _resolve_name
    self._raise_for_name(name, err)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\clsregistry.py", line 501, in _raise_for_name
    raise exc.InvalidRequestError(
    ...<5 lines>...
    ) from err
sqlalchemy.exc.InvalidRequestError: When initializing mapper Mapper[Sale(sales)], expression 'Refund' failed to locate a name ('Refund'). If this is a class name, consider adding this relationship() to the <class 'app.models.sale.Sale'> class after both dependent classes have been defined.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 35, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\starlette\concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\to_thread.py", line 61, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2525, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 986, in run
    result = context.run(func, *args)
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 214, in login
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: Une erreur est survenue lors de l'authentification.

2025-12-20 11:44:52,417 - app.api.v1.auth - INFO - Tentative de connexion pour l'email: kiongasplane@gmail.com
2025-12-20 11:44:52,640 - app.api.v1.auth - ERROR - Erreur inattendue lors de la connexion: InvalidRequestError("Mapper 'Mapper[Tenant(tenants)]' has no property 'refunds'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.")
2025-12-20 11:44:52,679 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2531, in get_property
    return self._props[key]
           ~~~~~~~~~~~^^^^^
KeyError: 'refunds'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1660, in do_init
    self._generate_backref()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2144, in _generate_backref
    self._add_reverse_property(self.back_populates)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1591, in _add_reverse_property
    other = self.mapper.get_property(key, _configure_mappers=False)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2533, in get_property
    raise sa_exc.InvalidRequestError(
    ...<3 lines>...
    ) from err
sqlalchemy.exc.InvalidRequestError: Mapper 'Mapper[Tenant(tenants)]' has no property 'refunds'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

2025-12-20 11:44:52,683 - app.api.v1.auth - ERROR - Erreur lors de l'ouverture de la session DB: HTTPException(status_code=500, detail="Une erreur est survenue lors de l'authentification.")
2025-12-20 11:44:52,707 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2531, in get_property
    return self._props[key]
           ~~~~~~~~~~~^^^^^
KeyError: 'refunds'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1660, in do_init
    self._generate_backref()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2144, in _generate_backref
    self._add_reverse_property(self.back_populates)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1591, in _add_reverse_property
    other = self.mapper.get_property(key, _configure_mappers=False)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2533, in get_property
    raise sa_exc.InvalidRequestError(
    ...<3 lines>...
    ) from err
sqlalchemy.exc.InvalidRequestError: Mapper 'Mapper[Tenant(tenants)]' has no property 'refunds'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 35, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\starlette\concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\to_thread.py", line 61, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2525, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 986, in run
    result = context.run(func, *args)
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 214, in login
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: Une erreur est survenue lors de l'authentification.

2025-12-20 11:48:28,387 - app.api.v1.auth - INFO - Tentative de connexion pour l'email: kiongasplane@gmail.com
2025-12-20 11:48:28,741 - app.api.v1.auth - ERROR - Erreur inattendue lors de la connexion: ArgumentError("Error creating backref 'processed_debt_payments' on relationship 'DebtPayment.processor': property of that name exists on mapper 'Mapper[User(users)]'")
2025-12-20 11:48:28,774 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1660, in do_init
    self._generate_backref()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2086, in _generate_backref
    raise sa_exc.ArgumentError(
    ...<4 lines>...
    )
sqlalchemy.exc.ArgumentError: Error creating backref 'processed_debt_payments' on relationship 'DebtPayment.processor': property of that name exists on mapper 'Mapper[User(users)]'

2025-12-20 11:48:28,779 - app.api.v1.auth - ERROR - Erreur lors de l'ouverture de la session DB: HTTPException(status_code=500, detail="Une erreur est survenue lors de l'authentification.")
2025-12-20 11:48:28,821 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1660, in do_init
    self._generate_backref()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2086, in _generate_backref
    raise sa_exc.ArgumentError(
    ...<4 lines>...
    )
sqlalchemy.exc.ArgumentError: Error creating backref 'processed_debt_payments' on relationship 'DebtPayment.processor': property of that name exists on mapper 'Mapper[User(users)]'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 35, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\starlette\concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\to_thread.py", line 61, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2525, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 986, in run
    result = context.run(func, *args)
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 214, in login
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: Une erreur est survenue lors de l'authentification.

2025-12-20 11:57:31,761 - app.api.v1.auth - INFO - Tentative de connexion pour l'email: kiongasplane@gmail.com
2025-12-20 11:57:32,169 - app.api.v1.auth - ERROR - Erreur inattendue lors de la connexion: InvalidRequestError("Mapper 'Mapper[Tenant(tenants)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.")
2025-12-20 11:57:32,200 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2531, in get_property
    return self._props[key]
           ~~~~~~~~~~~^^^^^
KeyError: 'payments'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1660, in do_init
    self._generate_backref()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2144, in _generate_backref
    self._add_reverse_property(self.back_populates)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1591, in _add_reverse_property
    other = self.mapper.get_property(key, _configure_mappers=False)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2533, in get_property
    raise sa_exc.InvalidRequestError(
    ...<3 lines>...
    ) from err
sqlalchemy.exc.InvalidRequestError: Mapper 'Mapper[Tenant(tenants)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

2025-12-20 11:57:32,205 - app.api.v1.auth - ERROR - Erreur lors de l'ouverture de la session DB: HTTPException(status_code=500, detail="Une erreur est survenue lors de l'authentification.")
2025-12-20 11:57:32,238 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2531, in get_property
    return self._props[key]
           ~~~~~~~~~~~^^^^^
KeyError: 'payments'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1660, in do_init
    self._generate_backref()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2144, in _generate_backref
    self._add_reverse_property(self.back_populates)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1591, in _add_reverse_property
    other = self.mapper.get_property(key, _configure_mappers=False)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2533, in get_property
    raise sa_exc.InvalidRequestError(
    ...<3 lines>...
    ) from err
sqlalchemy.exc.InvalidRequestError: Mapper 'Mapper[Tenant(tenants)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 35, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\starlette\concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\to_thread.py", line 61, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2525, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 986, in run
    result = context.run(func, *args)
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 214, in login
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: Une erreur est survenue lors de l'authentification.

2025-12-20 12:00:04,877 - app.api.v1.auth - INFO - Tentative de connexion pour l'email: kiongasplane@gmail.com
2025-12-20 12:00:05,091 - app.api.v1.auth - ERROR - Erreur inattendue lors de la connexion: InvalidRequestError("Mapper 'Mapper[Tenant(tenants)]' has no property 'refunds'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.")
2025-12-20 12:00:05,127 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2531, in get_property
    return self._props[key]
           ~~~~~~~~~~~^^^^^
KeyError: 'refunds'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1660, in do_init
    self._generate_backref()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2144, in _generate_backref
    self._add_reverse_property(self.back_populates)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1591, in _add_reverse_property
    other = self.mapper.get_property(key, _configure_mappers=False)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2533, in get_property
    raise sa_exc.InvalidRequestError(
    ...<3 lines>...
    ) from err
sqlalchemy.exc.InvalidRequestError: Mapper 'Mapper[Tenant(tenants)]' has no property 'refunds'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

2025-12-20 12:00:05,130 - app.api.v1.auth - ERROR - Erreur lors de l'ouverture de la session DB: HTTPException(status_code=500, detail="Une erreur est survenue lors de l'authentification.")
2025-12-20 12:00:05,147 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2531, in get_property
    return self._props[key]
           ~~~~~~~~~~~^^^^^
KeyError: 'refunds'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1660, in do_init
    self._generate_backref()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2144, in _generate_backref
    self._add_reverse_property(self.back_populates)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1591, in _add_reverse_property
    other = self.mapper.get_property(key, _configure_mappers=False)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2533, in get_property
    raise sa_exc.InvalidRequestError(
    ...<3 lines>...
    ) from err
sqlalchemy.exc.InvalidRequestError: Mapper 'Mapper[Tenant(tenants)]' has no property 'refunds'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 35, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\starlette\concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\to_thread.py", line 61, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2525, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 986, in run
    result = context.run(func, *args)
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 214, in login
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: Une erreur est survenue lors de l'authentification.

2025-12-20 12:07:47,862 - app.api.v1.auth - INFO - Tentative de connexion pour l'email: kiongasplane@pharma.com
2025-12-20 12:07:48,625 - app.api.v1.auth - ERROR - Erreur inattendue lors de la connexion: InvalidRequestError("Mapper 'Mapper[Tenant(tenants)]' has no property 'refunds'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.")
2025-12-20 12:07:48,827 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2531, in get_property
    return self._props[key]
           ~~~~~~~~~~~^^^^^
KeyError: 'refunds'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1660, in do_init
    self._generate_backref()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2144, in _generate_backref
    self._add_reverse_property(self.back_populates)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1591, in _add_reverse_property
    other = self.mapper.get_property(key, _configure_mappers=False)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2533, in get_property
    raise sa_exc.InvalidRequestError(
    ...<3 lines>...
    ) from err
sqlalchemy.exc.InvalidRequestError: Mapper 'Mapper[Tenant(tenants)]' has no property 'refunds'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

2025-12-20 12:07:48,854 - app.api.v1.auth - ERROR - Erreur lors de l'ouverture de la session DB: HTTPException(status_code=500, detail="Une erreur est survenue lors de l'authentification.")
2025-12-20 12:07:49,007 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2531, in get_property
    return self._props[key]
           ~~~~~~~~~~~^^^^^
KeyError: 'refunds'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1660, in do_init
    self._generate_backref()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2144, in _generate_backref
    self._add_reverse_property(self.back_populates)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1591, in _add_reverse_property
    other = self.mapper.get_property(key, _configure_mappers=False)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2533, in get_property
    raise sa_exc.InvalidRequestError(
    ...<3 lines>...
    ) from err
sqlalchemy.exc.InvalidRequestError: Mapper 'Mapper[Tenant(tenants)]' has no property 'refunds'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 35, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\starlette\concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\to_thread.py", line 61, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2525, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 986, in run
    result = context.run(func, *args)
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 214, in login
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: Une erreur est survenue lors de l'authentification.

2025-12-20 12:19:02,435 - app.api.v1.auth - INFO - Tentative de connexion pour l'email: kiongasplane@pharma.com
2025-12-20 12:19:02,791 - app.api.v1.auth - ERROR - Erreur inattendue lors de la connexion: InvalidRequestError("Mapper 'Mapper[Tenant(tenants)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.")
2025-12-20 12:19:02,823 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2531, in get_property
    return self._props[key]
           ~~~~~~~~~~~^^^^^
KeyError: 'payments'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1660, in do_init
    self._generate_backref()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2144, in _generate_backref
    self._add_reverse_property(self.back_populates)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1591, in _add_reverse_property
    other = self.mapper.get_property(key, _configure_mappers=False)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2533, in get_property
    raise sa_exc.InvalidRequestError(
    ...<3 lines>...
    ) from err
sqlalchemy.exc.InvalidRequestError: Mapper 'Mapper[Tenant(tenants)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

2025-12-20 12:19:02,827 - app.api.v1.auth - ERROR - Erreur lors de l'ouverture de la session DB: HTTPException(status_code=500, detail="Une erreur est survenue lors de l'authentification.")
2025-12-20 12:19:02,857 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2531, in get_property
    return self._props[key]
           ~~~~~~~~~~~^^^^^
KeyError: 'payments'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1660, in do_init
    self._generate_backref()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2144, in _generate_backref
    self._add_reverse_property(self.back_populates)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1591, in _add_reverse_property
    other = self.mapper.get_property(key, _configure_mappers=False)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2533, in get_property
    raise sa_exc.InvalidRequestError(
    ...<3 lines>...
    ) from err
sqlalchemy.exc.InvalidRequestError: Mapper 'Mapper[Tenant(tenants)]' has no property 'payments'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 35, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\starlette\concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\to_thread.py", line 61, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2525, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 986, in run
    result = context.run(func, *args)
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 214, in login
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: Une erreur est survenue lors de l'authentification.

2025-12-20 12:24:33,230 - app.api.v1.auth - INFO - Tentative de connexion pour l'email: kiongasplane@pharma.com
2025-12-20 12:24:33,580 - app.api.v1.auth - ERROR - Erreur inattendue lors de la connexion: ArgumentError("reverse_property 'payments' on relationship Payment.invoice references relationship Invoice.payments, which does not reference mapper Mapper[Payment(payments)]")
2025-12-20 12:24:33,616 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1660, in do_init
    self._generate_backref()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2144, in _generate_backref
    self._add_reverse_property(self.back_populates)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1615, in _add_reverse_property
    raise sa_exc.ArgumentError(
    ...<4 lines>...
    )
sqlalchemy.exc.ArgumentError: reverse_property 'payments' on relationship Payment.invoice references relationship Invoice.payments, which does not reference mapper Mapper[Payment(payments)]

2025-12-20 12:24:33,619 - app.api.v1.auth - ERROR - Erreur lors de l'ouverture de la session DB: HTTPException(status_code=500, detail="Une erreur est survenue lors de l'authentification.")
2025-12-20 12:24:33,644 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1660, in do_init
    self._generate_backref()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2144, in _generate_backref
    self._add_reverse_property(self.back_populates)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1615, in _add_reverse_property
    raise sa_exc.ArgumentError(
    ...<4 lines>...
    )
sqlalchemy.exc.ArgumentError: reverse_property 'payments' on relationship Payment.invoice references relationship Invoice.payments, which does not reference mapper Mapper[Payment(payments)]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 35, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\starlette\concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\to_thread.py", line 61, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2525, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 986, in run
    result = context.run(func, *args)
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 214, in login
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: Une erreur est survenue lors de l'authentification.

2025-12-20 12:31:51,643 - app.api.v1.auth - INFO - Tentative de connexion pour l'email: kiongasplane@pharma.com
2025-12-20 12:31:51,997 - app.api.v1.auth - ERROR - Erreur inattendue lors de la connexion: ArgumentError("reverse_property 'payments' on relationship Payment.invoice references relationship Invoice.payments, which does not reference mapper Mapper[Payment(payments)]")
2025-12-20 12:31:52,027 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1660, in do_init
    self._generate_backref()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2144, in _generate_backref
    self._add_reverse_property(self.back_populates)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1615, in _add_reverse_property
    raise sa_exc.ArgumentError(
    ...<4 lines>...
    )
sqlalchemy.exc.ArgumentError: reverse_property 'payments' on relationship Payment.invoice references relationship Invoice.payments, which does not reference mapper Mapper[Payment(payments)]

2025-12-20 12:31:52,030 - app.api.v1.auth - ERROR - Erreur lors de l'ouverture de la session DB: HTTPException(status_code=500, detail="Une erreur est survenue lors de l'authentification.")
2025-12-20 12:31:52,053 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1660, in do_init
    self._generate_backref()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2144, in _generate_backref
    self._add_reverse_property(self.back_populates)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1615, in _add_reverse_property
    raise sa_exc.ArgumentError(
    ...<4 lines>...
    )
sqlalchemy.exc.ArgumentError: reverse_property 'payments' on relationship Payment.invoice references relationship Invoice.payments, which does not reference mapper Mapper[Payment(payments)]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 35, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\starlette\concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\to_thread.py", line 61, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2525, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 986, in run
    result = context.run(func, *args)
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 214, in login
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: Une erreur est survenue lors de l'authentification.

2025-12-20 12:38:10,050 - app.api.v1.auth - INFO - Tentative de connexion pour l'email: kiongasplane@pharma.com
2025-12-20 12:38:10,339 - app.api.v1.auth - ERROR - Erreur inattendue lors de la connexion: ArgumentError("reverse_property 'payments' on relationship Payment.invoice references relationship Invoice.payments, which does not reference mapper Mapper[Payment(payments)]")
2025-12-20 12:38:10,361 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1660, in do_init
    self._generate_backref()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2144, in _generate_backref
    self._add_reverse_property(self.back_populates)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1615, in _add_reverse_property
    raise sa_exc.ArgumentError(
    ...<4 lines>...
    )
sqlalchemy.exc.ArgumentError: reverse_property 'payments' on relationship Payment.invoice references relationship Invoice.payments, which does not reference mapper Mapper[Payment(payments)]

2025-12-20 12:38:10,368 - app.api.v1.auth - ERROR - Erreur lors de l'ouverture de la session DB: HTTPException(status_code=500, detail="Une erreur est survenue lors de l'authentification.")
2025-12-20 12:38:10,396 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1660, in do_init
    self._generate_backref()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2144, in _generate_backref
    self._add_reverse_property(self.back_populates)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1615, in _add_reverse_property
    raise sa_exc.ArgumentError(
    ...<4 lines>...
    )
sqlalchemy.exc.ArgumentError: reverse_property 'payments' on relationship Payment.invoice references relationship Invoice.payments, which does not reference mapper Mapper[Payment(payments)]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 35, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\starlette\concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\to_thread.py", line 61, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2525, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 986, in run
    result = context.run(func, *args)
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 214, in login
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: Une erreur est survenue lors de l'authentification.

2025-12-20 12:42:30,320 - app.api.v1.auth - INFO - Tentative de connexion pour l'email: kiongasplane@pharma.com
2025-12-20 12:42:30,641 - app.api.v1.auth - ERROR - Erreur inattendue lors de la connexion: ArgumentError("reverse_property 'payments' on relationship Payment.invoice references relationship Invoice.payments, which does not reference mapper Mapper[Payment(payments)]")
2025-12-20 12:42:30,670 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1660, in do_init
    self._generate_backref()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2144, in _generate_backref
    self._add_reverse_property(self.back_populates)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1615, in _add_reverse_property
    raise sa_exc.ArgumentError(
    ...<4 lines>...
    )
sqlalchemy.exc.ArgumentError: reverse_property 'payments' on relationship Payment.invoice references relationship Invoice.payments, which does not reference mapper Mapper[Payment(payments)]

2025-12-20 12:42:30,673 - app.api.v1.auth - ERROR - Erreur lors de l'ouverture de la session DB: HTTPException(status_code=500, detail="Une erreur est survenue lors de l'authentification.")
2025-12-20 12:42:30,689 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1660, in do_init
    self._generate_backref()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2144, in _generate_backref
    self._add_reverse_property(self.back_populates)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1615, in _add_reverse_property
    raise sa_exc.ArgumentError(
    ...<4 lines>...
    )
sqlalchemy.exc.ArgumentError: reverse_property 'payments' on relationship Payment.invoice references relationship Invoice.payments, which does not reference mapper Mapper[Payment(payments)]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 35, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\starlette\concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\to_thread.py", line 61, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2525, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 986, in run
    result = context.run(func, *args)
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 214, in login
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: Une erreur est survenue lors de l'authentification.

2025-12-20 12:46:44,767 - app.api.v1.auth - INFO - Tentative de connexion pour l'email: kiongasplane@pharma.com
2025-12-20 12:46:45,650 - app.api.v1.auth - ERROR - Erreur inattendue lors de la connexion: ProgrammingError("(psycopg2.errors.UndefinedTable) ERREUR:  la relation  users  n'existe pas\nLINE 2: FROM users \n             ^\n")
2025-12-20 12:46:45,764 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.UndefinedTable: ERREUR:  la relation  users  n'existe pas
LINE 2: FROM users 
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 2759, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedTable) ERREUR:  la relation  users  n'existe pas
LINE 2: FROM users 
             ^

[SQL: SELECT users.id AS users_id, users.tenant_id AS users_tenant_id, users.nom AS users_nom, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.actif AS users_actif, users.telephone AS users_telephone, users.adresse AS users_adresse, users.date_creation AS users_date_creation, users.last_login AS users_last_login, users.date_modification AS users_date_modification 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s]
[parameters: {'email_1': 'kiongasplane@pharma.com', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-12-20 12:46:45,772 - app.api.v1.auth - ERROR - Erreur lors de l'ouverture de la session DB: HTTPException(status_code=500, detail="Une erreur est survenue lors de l'authentification.")
2025-12-20 12:46:45,809 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.UndefinedTable: ERREUR:  la relation  users  n'existe pas
LINE 2: FROM users 
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 2759, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
        params,
        ^^^^^^^
        execution_options={"_sa_orm_load_options": self.load_options},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedTable) ERREUR:  la relation  users  n'existe pas
LINE 2: FROM users 
             ^

[SQL: SELECT users.id AS users_id, users.tenant_id AS users_tenant_id, users.nom AS users_nom, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.actif AS users_actif, users.telephone AS users_telephone, users.adresse AS users_adresse, users.date_creation AS users_date_creation, users.last_login AS users_last_login, users.date_modification AS users_date_modification 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s]
[parameters: {'email_1': 'kiongasplane@pharma.com', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 35, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\starlette\concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\to_thread.py", line 61, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2525, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 986, in run
    result = context.run(func, *args)
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 214, in login
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: Une erreur est survenue lors de l'authentification.

2025-12-20 15:37:55,008 - app.api.v1.auth - INFO - Tentative de connexion pour l'email: kiongasplane@pharma.com
2025-12-20 15:37:55,866 - app.api.v1.auth - ERROR - Erreur inattendue lors de la connexion: InvalidRequestError("Mapper 'Mapper[Tenant(tenants)]' has no property 'financial_periods'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.")
2025-12-20 15:37:55,964 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2531, in get_property
    return self._props[key]
           ~~~~~~~~~~~^^^^^
KeyError: 'financial_periods'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1660, in do_init
    self._generate_backref()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2144, in _generate_backref
    self._add_reverse_property(self.back_populates)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1591, in _add_reverse_property
    other = self.mapper.get_property(key, _configure_mappers=False)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2533, in get_property
    raise sa_exc.InvalidRequestError(
    ...<3 lines>...
    ) from err
sqlalchemy.exc.InvalidRequestError: Mapper 'Mapper[Tenant(tenants)]' has no property 'financial_periods'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

2025-12-20 15:37:55,974 - app.api.v1.auth - ERROR - Erreur lors de l'ouverture de la session DB: HTTPException(status_code=500, detail="Une erreur est survenue lors de l'authentification.")
2025-12-20 15:37:56,060 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2531, in get_property
    return self._props[key]
           ~~~~~~~~~~~^^^^^
KeyError: 'financial_periods'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1660, in do_init
    self._generate_backref()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2144, in _generate_backref
    self._add_reverse_property(self.back_populates)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1591, in _add_reverse_property
    other = self.mapper.get_property(key, _configure_mappers=False)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2533, in get_property
    raise sa_exc.InvalidRequestError(
    ...<3 lines>...
    ) from err
sqlalchemy.exc.InvalidRequestError: Mapper 'Mapper[Tenant(tenants)]' has no property 'financial_periods'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 35, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\starlette\concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\to_thread.py", line 61, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2525, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 986, in run
    result = context.run(func, *args)
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 214, in login
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: Une erreur est survenue lors de l'authentification.

2025-12-20 16:04:54,162 - app.api.v1.auth - INFO - Tentative de connexion pour l'email: kiongasplane@pharma.com
2025-12-20 16:04:55,913 - app.api.v1.auth - ERROR - Erreur inattendue lors de la connexion: NoForeignKeysError("Could not determine join condition between parent/child tables on relationship FinancialTransaction.sale - there are no foreign keys linking these tables.  Ensure that referencing columns are associated with a ForeignKey or ForeignKeyConstraint, or specify a 'primaryjoin' expression.")
2025-12-20 16:04:56,082 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2434, in _determine_joins
    self.primaryjoin = join_condition(
                       ~~~~~~~~~~~~~~^
        self.parent_persist_selectable,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        consider_as_foreign_keys=consider_as_foreign_keys,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\util.py", line 121, in join_condition
    return Join._join_condition(
           ~~~~~~~~~~~~~~~~~~~~^
        a,
        ^^
    ...<2 lines>...
        consider_as_foreign_keys=consider_as_foreign_keys,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\selectable.py", line 1453, in _join_condition
    raise exc.NoForeignKeysError(
    ...<3 lines>...
    )
sqlalchemy.exc.NoForeignKeysError: Can't find any foreign key relationships between 'financial_transactions' and 'sales'.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1657, in do_init
    self._setup_join_conditions()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1895, in _setup_join_conditions
    self._join_condition = jc = JoinCondition(
                                ~~~~~~~~~~~~~^
        parent_persist_selectable=self.parent.persist_selectable,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<14 lines>...
        can_be_synced_fn=self._columns_are_mapped,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2321, in __init__
    self._determine_joins()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2455, in _determine_joins
    raise sa_exc.NoForeignKeysError(
    ...<7 lines>...
    ) from nfe
sqlalchemy.exc.NoForeignKeysError: Could not determine join condition between parent/child tables on relationship FinancialTransaction.sale - there are no foreign keys linking these tables.  Ensure that referencing columns are associated with a ForeignKey or ForeignKeyConstraint, or specify a 'primaryjoin' expression.

2025-12-20 16:04:56,098 - app.api.v1.auth - ERROR - Erreur lors de l'ouverture de la session DB: HTTPException(status_code=500, detail="Une erreur est survenue lors de l'authentification.")
2025-12-20 16:04:56,219 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2434, in _determine_joins
    self.primaryjoin = join_condition(
                       ~~~~~~~~~~~~~~^
        self.parent_persist_selectable,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        consider_as_foreign_keys=consider_as_foreign_keys,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\util.py", line 121, in join_condition
    return Join._join_condition(
           ~~~~~~~~~~~~~~~~~~~~^
        a,
        ^^
    ...<2 lines>...
        consider_as_foreign_keys=consider_as_foreign_keys,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\selectable.py", line 1453, in _join_condition
    raise exc.NoForeignKeysError(
    ...<3 lines>...
    )
sqlalchemy.exc.NoForeignKeysError: Can't find any foreign key relationships between 'financial_transactions' and 'sales'.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1657, in do_init
    self._setup_join_conditions()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1895, in _setup_join_conditions
    self._join_condition = jc = JoinCondition(
                                ~~~~~~~~~~~~~^
        parent_persist_selectable=self.parent.persist_selectable,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<14 lines>...
        can_be_synced_fn=self._columns_are_mapped,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2321, in __init__
    self._determine_joins()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2455, in _determine_joins
    raise sa_exc.NoForeignKeysError(
    ...<7 lines>...
    ) from nfe
sqlalchemy.exc.NoForeignKeysError: Could not determine join condition between parent/child tables on relationship FinancialTransaction.sale - there are no foreign keys linking these tables.  Ensure that referencing columns are associated with a ForeignKey or ForeignKeyConstraint, or specify a 'primaryjoin' expression.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 35, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\starlette\concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\to_thread.py", line 61, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2525, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 986, in run
    result = context.run(func, *args)
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 214, in login
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: Une erreur est survenue lors de l'authentification.

2025-12-20 16:19:54,553 - app.api.v1.auth - INFO - Tentative de connexion pour l'email: kiongasplane@pharma.com
2025-12-20 16:19:56,549 - app.api.v1.auth - ERROR - Erreur inattendue lors de la connexion: AmbiguousForeignKeysError("Could not determine join condition between parent/child tables on relationship FinancialTransaction.expense - there are multiple foreign key paths linking the tables.  Specify the 'foreign_keys' argument, providing a list of those columns which should be counted as containing a foreign key reference to the parent table.")
2025-12-20 16:19:56,761 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2434, in _determine_joins
    self.primaryjoin = join_condition(
                       ~~~~~~~~~~~~~~^
        self.parent_persist_selectable,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        consider_as_foreign_keys=consider_as_foreign_keys,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\util.py", line 121, in join_condition
    return Join._join_condition(
           ~~~~~~~~~~~~~~~~~~~~^
        a,
        ^^
    ...<2 lines>...
        consider_as_foreign_keys=consider_as_foreign_keys,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\selectable.py", line 1441, in _join_condition
    cls._joincond_trim_constraints(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        a, b, constraints, consider_as_foreign_keys
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\selectable.py", line 1586, in _joincond_trim_constraints
    raise exc.AmbiguousForeignKeysError(
    ...<5 lines>...
    )
sqlalchemy.exc.AmbiguousForeignKeysError: Can't determine join between 'financial_transactions' and 'expenses'; tables have more than one foreign key constraint relationship between them. Please specify the 'onclause' of this join explicitly.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1657, in do_init
    self._setup_join_conditions()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1895, in _setup_join_conditions
    self._join_condition = jc = JoinCondition(
                                ~~~~~~~~~~~~~^
        parent_persist_selectable=self.parent.persist_selectable,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<14 lines>...
        can_be_synced_fn=self._columns_are_mapped,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2321, in __init__
    self._determine_joins()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2478, in _determine_joins
    raise sa_exc.AmbiguousForeignKeysError(
    ...<7 lines>...
    ) from afe
sqlalchemy.exc.AmbiguousForeignKeysError: Could not determine join condition between parent/child tables on relationship FinancialTransaction.expense - there are multiple foreign key paths linking the tables.  Specify the 'foreign_keys' argument, providing a list of those columns which should be counted as containing a foreign key reference to the parent table.

2025-12-20 16:19:56,790 - app.api.v1.auth - ERROR - Erreur lors de l'ouverture de la session DB: HTTPException(status_code=500, detail="Une erreur est survenue lors de l'authentification.")
2025-12-20 16:19:56,909 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2434, in _determine_joins
    self.primaryjoin = join_condition(
                       ~~~~~~~~~~~~~~^
        self.parent_persist_selectable,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        consider_as_foreign_keys=consider_as_foreign_keys,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\util.py", line 121, in join_condition
    return Join._join_condition(
           ~~~~~~~~~~~~~~~~~~~~^
        a,
        ^^
    ...<2 lines>...
        consider_as_foreign_keys=consider_as_foreign_keys,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\selectable.py", line 1441, in _join_condition
    cls._joincond_trim_constraints(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        a, b, constraints, consider_as_foreign_keys
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\selectable.py", line 1586, in _joincond_trim_constraints
    raise exc.AmbiguousForeignKeysError(
    ...<5 lines>...
    )
sqlalchemy.exc.AmbiguousForeignKeysError: Can't determine join between 'financial_transactions' and 'expenses'; tables have more than one foreign key constraint relationship between them. Please specify the 'onclause' of this join explicitly.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1657, in do_init
    self._setup_join_conditions()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1895, in _setup_join_conditions
    self._join_condition = jc = JoinCondition(
                                ~~~~~~~~~~~~~^
        parent_persist_selectable=self.parent.persist_selectable,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<14 lines>...
        can_be_synced_fn=self._columns_are_mapped,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2321, in __init__
    self._determine_joins()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2478, in _determine_joins
    raise sa_exc.AmbiguousForeignKeysError(
    ...<7 lines>...
    ) from afe
sqlalchemy.exc.AmbiguousForeignKeysError: Could not determine join condition between parent/child tables on relationship FinancialTransaction.expense - there are multiple foreign key paths linking the tables.  Specify the 'foreign_keys' argument, providing a list of those columns which should be counted as containing a foreign key reference to the parent table.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 35, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\starlette\concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\to_thread.py", line 61, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2525, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 986, in run
    result = context.run(func, *args)
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 214, in login
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: Une erreur est survenue lors de l'authentification.

2025-12-20 16:37:07,705 - app.api.v1.auth - INFO - Tentative de connexion pour l'email: kiongasplane@pharma.com
2025-12-20 16:37:09,183 - app.api.v1.auth - ERROR - Erreur inattendue lors de la connexion: AmbiguousForeignKeysError("Could not determine join condition between parent/child tables on relationship FinancialTransaction.expense - there are multiple foreign key paths linking the tables.  Specify the 'foreign_keys' argument, providing a list of those columns which should be counted as containing a foreign key reference to the parent table.")
2025-12-20 16:37:09,257 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2434, in _determine_joins
    self.primaryjoin = join_condition(
                       ~~~~~~~~~~~~~~^
        self.parent_persist_selectable,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        consider_as_foreign_keys=consider_as_foreign_keys,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\util.py", line 121, in join_condition
    return Join._join_condition(
           ~~~~~~~~~~~~~~~~~~~~^
        a,
        ^^
    ...<2 lines>...
        consider_as_foreign_keys=consider_as_foreign_keys,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\selectable.py", line 1441, in _join_condition
    cls._joincond_trim_constraints(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        a, b, constraints, consider_as_foreign_keys
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\selectable.py", line 1586, in _joincond_trim_constraints
    raise exc.AmbiguousForeignKeysError(
    ...<5 lines>...
    )
sqlalchemy.exc.AmbiguousForeignKeysError: Can't determine join between 'financial_transactions' and 'expenses'; tables have more than one foreign key constraint relationship between them. Please specify the 'onclause' of this join explicitly.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1657, in do_init
    self._setup_join_conditions()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1895, in _setup_join_conditions
    self._join_condition = jc = JoinCondition(
                                ~~~~~~~~~~~~~^
        parent_persist_selectable=self.parent.persist_selectable,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<14 lines>...
        can_be_synced_fn=self._columns_are_mapped,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2321, in __init__
    self._determine_joins()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2478, in _determine_joins
    raise sa_exc.AmbiguousForeignKeysError(
    ...<7 lines>...
    ) from afe
sqlalchemy.exc.AmbiguousForeignKeysError: Could not determine join condition between parent/child tables on relationship FinancialTransaction.expense - there are multiple foreign key paths linking the tables.  Specify the 'foreign_keys' argument, providing a list of those columns which should be counted as containing a foreign key reference to the parent table.

2025-12-20 16:37:09,270 - app.api.v1.auth - ERROR - Erreur lors de l'ouverture de la session DB: HTTPException(status_code=500, detail="Une erreur est survenue lors de l'authentification.")
2025-12-20 16:37:09,309 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2434, in _determine_joins
    self.primaryjoin = join_condition(
                       ~~~~~~~~~~~~~~^
        self.parent_persist_selectable,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        consider_as_foreign_keys=consider_as_foreign_keys,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\util.py", line 121, in join_condition
    return Join._join_condition(
           ~~~~~~~~~~~~~~~~~~~~^
        a,
        ^^
    ...<2 lines>...
        consider_as_foreign_keys=consider_as_foreign_keys,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\selectable.py", line 1441, in _join_condition
    cls._joincond_trim_constraints(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        a, b, constraints, consider_as_foreign_keys
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\selectable.py", line 1586, in _joincond_trim_constraints
    raise exc.AmbiguousForeignKeysError(
    ...<5 lines>...
    )
sqlalchemy.exc.AmbiguousForeignKeysError: Can't determine join between 'financial_transactions' and 'expenses'; tables have more than one foreign key constraint relationship between them. Please specify the 'onclause' of this join explicitly.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1657, in do_init
    self._setup_join_conditions()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1895, in _setup_join_conditions
    self._join_condition = jc = JoinCondition(
                                ~~~~~~~~~~~~~^
        parent_persist_selectable=self.parent.persist_selectable,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<14 lines>...
        can_be_synced_fn=self._columns_are_mapped,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2321, in __init__
    self._determine_joins()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2478, in _determine_joins
    raise sa_exc.AmbiguousForeignKeysError(
    ...<7 lines>...
    ) from afe
sqlalchemy.exc.AmbiguousForeignKeysError: Could not determine join condition between parent/child tables on relationship FinancialTransaction.expense - there are multiple foreign key paths linking the tables.  Specify the 'foreign_keys' argument, providing a list of those columns which should be counted as containing a foreign key reference to the parent table.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 35, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\starlette\concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\to_thread.py", line 61, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2525, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 986, in run
    result = context.run(func, *args)
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 214, in login
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: Une erreur est survenue lors de l'authentification.

2025-12-20 16:48:04,934 - app.api.v1.auth - INFO - Tentative de connexion pour l'email: kiongasplane@gmail.com
2025-12-20 16:48:06,504 - app.api.v1.auth - ERROR - Erreur inattendue lors de la connexion: AmbiguousForeignKeysError("Could not determine join condition between parent/child tables on relationship FinancialTransaction.expense - there are multiple foreign key paths linking the tables.  Specify the 'foreign_keys' argument, providing a list of those columns which should be counted as containing a foreign key reference to the parent table.")
2025-12-20 16:48:06,609 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2434, in _determine_joins
    self.primaryjoin = join_condition(
                       ~~~~~~~~~~~~~~^
        self.parent_persist_selectable,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        consider_as_foreign_keys=consider_as_foreign_keys,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\util.py", line 121, in join_condition
    return Join._join_condition(
           ~~~~~~~~~~~~~~~~~~~~^
        a,
        ^^
    ...<2 lines>...
        consider_as_foreign_keys=consider_as_foreign_keys,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\selectable.py", line 1441, in _join_condition
    cls._joincond_trim_constraints(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        a, b, constraints, consider_as_foreign_keys
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\selectable.py", line 1586, in _joincond_trim_constraints
    raise exc.AmbiguousForeignKeysError(
    ...<5 lines>...
    )
sqlalchemy.exc.AmbiguousForeignKeysError: Can't determine join between 'financial_transactions' and 'expenses'; tables have more than one foreign key constraint relationship between them. Please specify the 'onclause' of this join explicitly.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1657, in do_init
    self._setup_join_conditions()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1895, in _setup_join_conditions
    self._join_condition = jc = JoinCondition(
                                ~~~~~~~~~~~~~^
        parent_persist_selectable=self.parent.persist_selectable,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<14 lines>...
        can_be_synced_fn=self._columns_are_mapped,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2321, in __init__
    self._determine_joins()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2478, in _determine_joins
    raise sa_exc.AmbiguousForeignKeysError(
    ...<7 lines>...
    ) from afe
sqlalchemy.exc.AmbiguousForeignKeysError: Could not determine join condition between parent/child tables on relationship FinancialTransaction.expense - there are multiple foreign key paths linking the tables.  Specify the 'foreign_keys' argument, providing a list of those columns which should be counted as containing a foreign key reference to the parent table.

2025-12-20 16:48:06,621 - app.api.v1.auth - ERROR - Erreur lors de l'ouverture de la session DB: HTTPException(status_code=500, detail="Une erreur est survenue lors de l'authentification.")
2025-12-20 16:48:06,675 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2434, in _determine_joins
    self.primaryjoin = join_condition(
                       ~~~~~~~~~~~~~~^
        self.parent_persist_selectable,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        consider_as_foreign_keys=consider_as_foreign_keys,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\util.py", line 121, in join_condition
    return Join._join_condition(
           ~~~~~~~~~~~~~~~~~~~~^
        a,
        ^^
    ...<2 lines>...
        consider_as_foreign_keys=consider_as_foreign_keys,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\selectable.py", line 1441, in _join_condition
    cls._joincond_trim_constraints(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        a, b, constraints, consider_as_foreign_keys
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\selectable.py", line 1586, in _joincond_trim_constraints
    raise exc.AmbiguousForeignKeysError(
    ...<5 lines>...
    )
sqlalchemy.exc.AmbiguousForeignKeysError: Can't determine join between 'financial_transactions' and 'expenses'; tables have more than one foreign key constraint relationship between them. Please specify the 'onclause' of this join explicitly.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1657, in do_init
    self._setup_join_conditions()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1895, in _setup_join_conditions
    self._join_condition = jc = JoinCondition(
                                ~~~~~~~~~~~~~^
        parent_persist_selectable=self.parent.persist_selectable,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<14 lines>...
        can_be_synced_fn=self._columns_are_mapped,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2321, in __init__
    self._determine_joins()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2478, in _determine_joins
    raise sa_exc.AmbiguousForeignKeysError(
    ...<7 lines>...
    ) from afe
sqlalchemy.exc.AmbiguousForeignKeysError: Could not determine join condition between parent/child tables on relationship FinancialTransaction.expense - there are multiple foreign key paths linking the tables.  Specify the 'foreign_keys' argument, providing a list of those columns which should be counted as containing a foreign key reference to the parent table.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 35, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\starlette\concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\to_thread.py", line 61, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2525, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 986, in run
    result = context.run(func, *args)
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 214, in login
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: Une erreur est survenue lors de l'authentification.

2025-12-20 16:49:44,844 - app.api.v1.auth - INFO - Tentative de connexion pour l'email: kiongasplane@gmail.com
2025-12-20 16:49:45,732 - app.api.v1.auth - ERROR - Erreur inattendue lors de la connexion: AmbiguousForeignKeysError("Could not determine join condition between parent/child tables on relationship FinancialTransaction.expense - there are multiple foreign key paths linking the tables.  Specify the 'foreign_keys' argument, providing a list of those columns which should be counted as containing a foreign key reference to the parent table.")
2025-12-20 16:49:45,828 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2434, in _determine_joins
    self.primaryjoin = join_condition(
                       ~~~~~~~~~~~~~~^
        self.parent_persist_selectable,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        consider_as_foreign_keys=consider_as_foreign_keys,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\util.py", line 121, in join_condition
    return Join._join_condition(
           ~~~~~~~~~~~~~~~~~~~~^
        a,
        ^^
    ...<2 lines>...
        consider_as_foreign_keys=consider_as_foreign_keys,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\selectable.py", line 1441, in _join_condition
    cls._joincond_trim_constraints(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        a, b, constraints, consider_as_foreign_keys
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\selectable.py", line 1586, in _joincond_trim_constraints
    raise exc.AmbiguousForeignKeysError(
    ...<5 lines>...
    )
sqlalchemy.exc.AmbiguousForeignKeysError: Can't determine join between 'financial_transactions' and 'expenses'; tables have more than one foreign key constraint relationship between them. Please specify the 'onclause' of this join explicitly.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1657, in do_init
    self._setup_join_conditions()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1895, in _setup_join_conditions
    self._join_condition = jc = JoinCondition(
                                ~~~~~~~~~~~~~^
        parent_persist_selectable=self.parent.persist_selectable,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<14 lines>...
        can_be_synced_fn=self._columns_are_mapped,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2321, in __init__
    self._determine_joins()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2478, in _determine_joins
    raise sa_exc.AmbiguousForeignKeysError(
    ...<7 lines>...
    ) from afe
sqlalchemy.exc.AmbiguousForeignKeysError: Could not determine join condition between parent/child tables on relationship FinancialTransaction.expense - there are multiple foreign key paths linking the tables.  Specify the 'foreign_keys' argument, providing a list of those columns which should be counted as containing a foreign key reference to the parent table.

2025-12-20 16:49:45,840 - app.api.v1.auth - ERROR - Erreur lors de l'ouverture de la session DB: HTTPException(status_code=500, detail="Une erreur est survenue lors de l'authentification.")
2025-12-20 16:49:45,927 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2434, in _determine_joins
    self.primaryjoin = join_condition(
                       ~~~~~~~~~~~~~~^
        self.parent_persist_selectable,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        consider_as_foreign_keys=consider_as_foreign_keys,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\util.py", line 121, in join_condition
    return Join._join_condition(
           ~~~~~~~~~~~~~~~~~~~~^
        a,
        ^^
    ...<2 lines>...
        consider_as_foreign_keys=consider_as_foreign_keys,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\selectable.py", line 1441, in _join_condition
    cls._joincond_trim_constraints(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        a, b, constraints, consider_as_foreign_keys
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\selectable.py", line 1586, in _joincond_trim_constraints
    raise exc.AmbiguousForeignKeysError(
    ...<5 lines>...
    )
sqlalchemy.exc.AmbiguousForeignKeysError: Can't determine join between 'financial_transactions' and 'expenses'; tables have more than one foreign key constraint relationship between them. Please specify the 'onclause' of this join explicitly.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 142, in login
    user = db.query(User).filter(User.email == email).first()
           ~~~~~~~~^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2941, in query
    return self._query_cls(entities, self, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 276, in __init__
    self._set_entities(entities)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 289, in _set_entities
    coercions.expect(
    ~~~~~~~~~~~~~~~~^
        roles.ColumnsClauseRole,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        post_inspect=True,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2733, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2410, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4227, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4268, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2427, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1657, in do_init
    self._setup_join_conditions()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1895, in _setup_join_conditions
    self._join_condition = jc = JoinCondition(
                                ~~~~~~~~~~~~~^
        parent_persist_selectable=self.parent.persist_selectable,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<14 lines>...
        can_be_synced_fn=self._columns_are_mapped,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2321, in __init__
    self._determine_joins()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2478, in _determine_joins
    raise sa_exc.AmbiguousForeignKeysError(
    ...<7 lines>...
    ) from afe
sqlalchemy.exc.AmbiguousForeignKeysError: Could not determine join condition between parent/child tables on relationship FinancialTransaction.expense - there are multiple foreign key paths linking the tables.  Specify the 'foreign_keys' argument, providing a list of those columns which should be counted as containing a foreign key reference to the parent table.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 35, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\starlette\concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\to_thread.py", line 61, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2525, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 986, in run
    result = context.run(func, *args)
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 214, in login
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: Une erreur est survenue lors de l'authentification.

2025-12-20 17:12:51,278 - app.api.v1.auth - INFO - Tentative de connexion pour l'email: kiongasplane@gmail.com
2025-12-20 17:12:52,150 - app.api.v1.auth - WARNING - Tentative de connexion avec email inconnu: kiongasplane@gmail.com
2025-12-20 17:12:52,151 - app.api.v1.auth - WARNING - Erreur HTTP dans login: 401 - Email ou mot de passe incorrect
2025-12-20 17:12:52,153 - app.api.v1.auth - ERROR - Erreur lors de l'ouverture de la session DB: HTTPException(status_code=401, detail='Email ou mot de passe incorrect')
2025-12-20 17:12:52,167 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 35, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\starlette\concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\to_thread.py", line 61, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2525, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 986, in run
    result = context.run(func, *args)
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 208, in login
    raise http_exc
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 146, in login
    raise HTTPException(
    ...<3 lines>...
    )
fastapi.exceptions.HTTPException: 401: Email ou mot de passe incorrect

2025-12-20 17:25:09,158 - app.api.v1.auth - INFO - Tentative de connexion pour l'email: kiongasplane@gmail.com
2025-12-20 17:25:09,881 - app.api.v1.auth - WARNING - Tentative de connexion avec email inconnu: kiongasplane@gmail.com
2025-12-20 17:25:09,882 - app.api.v1.auth - WARNING - Erreur HTTP dans login: 401 - Email ou mot de passe incorrect
2025-12-20 17:25:09,884 - app.api.v1.auth - ERROR - Erreur lors de l'ouverture de la session DB: HTTPException(status_code=401, detail='Email ou mot de passe incorrect')
2025-12-20 17:25:09,904 - app.api.v1.auth - ERROR - Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 35, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\starlette\concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\to_thread.py", line 61, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2525, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 986, in run
    result = context.run(func, *args)
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 208, in login
    raise http_exc
  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 146, in login
    raise HTTPException(
    ...<3 lines>...
    )
fastapi.exceptions.HTTPException: 401: Email ou mot de passe incorrect

2025-12-20 20:25:53,691 - app.db.session - ERROR - Erreur inattendue
Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\db\session.py", line 37, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 470, in app
    raise validation_error
fastapi.exceptions.RequestValidationError: 12 validation errors:
  {'type': 'missing', 'loc': ('body', 'confirm_password'), 'msg': 'Field required', 'input': {'email': 'kiongasplane@pharma.com', 'password': '2026Fam@', 'nom_complet': 'MBOMBO MBUYA', 'nom_pharmacie': 'BERKIOS PHARMA', 'ville': 'KINSHASA', 'telephone': '+243820586551', 'adresse': '3, AVENUE KANZA', 'type_pharmacie': 'parapharmacie', 'nom_entreprise': 'WISDOM SOCIETY', 'telephone_secondaire': '', 'province': 'KINSHASA', 'pays': 'Rpublique Dmocratique du Congo', 'numero_agrement': '', 'nom_proprietaire': 'MBOMBO MBUYA', 'id_nat': ''}}
  {'type': 'extra_forbidden', 'loc': ('body', 'nom_pharmacie'), 'msg': 'Extra inputs are not permitted', 'input': 'BERKIOS PHARMA'}
  {'type': 'extra_forbidden', 'loc': ('body', 'ville'), 'msg': 'Extra inputs are not permitted', 'input': 'KINSHASA'}
  {'type': 'extra_forbidden', 'loc': ('body', 'adresse'), 'msg': 'Extra inputs are not permitted', 'input': '3, AVENUE KANZA'}
  {'type': 'extra_forbidden', 'loc': ('body', 'type_pharmacie'), 'msg': 'Extra inputs are not permitted', 'input': 'parapharmacie'}
  {'type': 'extra_forbidden', 'loc': ('body', 'nom_entreprise'), 'msg': 'Extra inputs are not permitted', 'input': 'WISDOM SOCIETY'}
  {'type': 'extra_forbidden', 'loc': ('body', 'telephone_secondaire'), 'msg': 'Extra inputs are not permitted', 'input': ''}
  {'type': 'extra_forbidden', 'loc': ('body', 'province'), 'msg': 'Extra inputs are not permitted', 'input': 'KINSHASA'}
  {'type': 'extra_forbidden', 'loc': ('body', 'pays'), 'msg': 'Extra inputs are not permitted', 'input': 'Rpublique Dmocratique du Congo'}
  {'type': 'extra_forbidden', 'loc': ('body', 'numero_agrement'), 'msg': 'Extra inputs are not permitted', 'input': ''}
  {'type': 'extra_forbidden', 'loc': ('body', 'nom_proprietaire'), 'msg': 'Extra inputs are not permitted', 'input': 'MBOMBO MBUYA'}
  {'type': 'extra_forbidden', 'loc': ('body', 'id_nat'), 'msg': 'Extra inputs are not permitted', 'input': ''}

  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 34, in register_tenant
    POST /auth/tenants/register
2025-12-21 22:28:54,540 - app.db.session - ERROR - Erreur inattendue
Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\db\session.py", line 37, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 470, in app
    raise validation_error
fastapi.exceptions.RequestValidationError: 1 validation error:
  {'type': 'missing', 'loc': ('body', 'confirm_password'), 'msg': 'Field required', 'input': {'email': 'kionga@pharma.com', 'password': '2026Fami@', 'nom_complet': 'KIONGA SPLANE', 'nom_pharmacie': 'BERKIOS PHARMA', 'ville': 'KINSHASA', 'telephone': '0820586551', 'adresse': 'KANZA 3', 'type_pharmacie': 'parapharmacie', 'nom_entreprise': 'WISDOM SOCIETY', 'telephone_secondaire': '0849815290', 'province': '', 'pays': 'RDC', 'numero_agrement': '', 'nom_proprietaire': 'KIONGA SPLANE', 'id_nat': ''}}

  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 91, in register_tenant
    POST /auth/tenants/register
2025-12-22 10:58:03,466 - app.db.session - ERROR - Erreur inattendue
Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\db\session.py", line 37, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 470, in app
    raise validation_error
fastapi.exceptions.RequestValidationError: 1 validation error:
  {'type': 'missing', 'loc': ('body', 'confirm_password'), 'msg': 'Field required', 'input': {'email': 'daniella@pharma.com', 'password': '2026Fami@', 'nom_complet': 'CELINE MBADU', 'nom_pharmacie': 'DANIELLA PHARMA', 'ville': 'KINSHASA', 'telephone': '0820586551', 'adresse': 'REGIDESO 10', 'type_pharmacie': 'parapharmacie', 'nom_entreprise': '', 'telephone_secondaire': '', 'province': '', 'pays': 'RDC', 'numero_agrement': '', 'nom_proprietaire': 'CELINE MBADU', 'id_nat': ''}}

  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 91, in register_tenant
    POST /auth/tenants/register
2025-12-22 11:14:21,035 - app.db.session - ERROR - Erreur inattendue
Traceback (most recent call last):
  File "D:\educapp_saas\pharma_saas_backend\app\db\session.py", line 37, in get_db
    yield db
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\concurrency.py", line 29, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "D:\educapp_saas\pharma_saas_backend\venv\Lib\site-packages\fastapi\routing.py", line 470, in app
    raise validation_error
fastapi.exceptions.RequestValidationError: 1 validation error:
  {'type': 'missing', 'loc': ('body', 'confirm_password'), 'msg': 'Field required', 'input': {'email': 'daniella@pharma.com', 'password': '2026Fami@', 'nom_complet': 'CELINE MBADU', 'nom_pharmacie': 'DANIELLA PHARMA', 'ville': 'KINSHASA', 'telephone': '0820586551', 'adresse': 'KANZA 3', 'type_pharmacie': 'parapharmacie', 'nom_entreprise': '', 'telephone_secondaire': '', 'province': '', 'pays': 'RDC', 'numero_agrement': '', 'nom_proprietaire': 'CELINE MBADU', 'id_nat': ''}}

  File "D:\educapp_saas\pharma_saas_backend\app\api\v1\auth.py", line 96, in register_tenant
    POST /auth/tenants/register
